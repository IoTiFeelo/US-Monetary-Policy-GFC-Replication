<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Carbonara without Cream">

<title>Macroeconometrics Research Report - An U.S. Transmission Model Reproduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">An U.S. Transmission Model Reproduction</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Carbonara without Cream </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
.justify {
text-align: justify !important
}
</style>
</div>
<div class="justify">
<blockquote class="blockquote">
<p><strong>Abstract.</strong> This study tries to replicate Miranda-Agrippino,Rey(2020) implementing the framework of Møller,Wolf(2021). We implement a Bayesian SVAR and study the causality of our variables implementing Impulse Response Functions and Forecast Error Variance Decompositions.</p>
<p><strong>Keywords.</strong> Monetary Policy, US transmission mechanism, Bayesian SVAR</p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>We replicate <span class="citation" data-cites="miranda2020us">Miranda-Agrippino and Rey (<a href="#ref-miranda2020us" role="doc-biblioref">2020</a>)</span>, Review of Economic Studies, implementing an original approach developed by <span class="citation" data-cites="MollerWolf2021LPVARS">Plagborg-Moller (<a href="#ref-MollerWolf2021LPVARS" role="doc-biblioref">2021</a>)</span>. The former authors jointly evaluate the effects of financial, monetary and real variables, in the U.S. and abroad, following a 1% shock of the Federal Reserve (FED) interest rate. In particular, the authors rely on an instrumental variable to identify U.S. monetary policy shocks. This is to avoid implausible restrictions on their variable of interest. Our task will be to understand the model of these two scholars and replicate it with simplifications. This is given the time scope of the Macroeconometrics course taught by Dr.&nbsp;<a href="https://findanexpert.unimelb.edu.au/profile/426516-tomasz-wozniak">Tomasz Woźniak</a>. The specific challenge will be to adapt the Macroeconometrics R functions provided by the Lecturer and write R codes to disentangle the authors’ framework.</p>
</section>
<section id="the-paper" class="level1">
<h1>The Paper</h1>
<section id="global-factor-in-risky-asset-prices" class="level2">
<h2 class="anchored" data-anchor-id="global-factor-in-risky-asset-prices">Global Factor in Risky Asset Prices</h2>
<p><a href="http://helenerey.eu/Content/_Documents/MirandaAgrippinoRey_REStud_Final.pdf">Miranda-Agrippino and Rey</a> in the first part of the paper estimate a global factor to proxy the movement of world risky asset prices. They do so by collecting 858 prices of different risky assets traded in North America, Latin America, Europe, Asia Pacific, and Australia, from 1990 to 2012. Their method is to pick a representative market index (i.e.&nbsp;S&amp;P 500) for each market at the end of 2012, including all of its components, selecting prices that allow them to cover at least 80% of cross sectional observations by 1990 and 95% in 1995. They do so to avoid over-representation of each category. They use the first difference log-priced series. With this global factor, they can explain over 20% of global risky asset price volatility in their time span. Given the small time frame and VAR analysis limitations, they estimate a global factor with commodities from the U.S., Europe, and Japan, spanning back to 1975. This factor covers 60% of the volatility in this period. The appendix of the paper provides detailed information on this VAR estimation. To provide more intuition on this factor, the authors correlate it with some implied indexes volatility such as the VIX, outlining its co-movement with common measures of market variation (in this case a negative correlation). The global factor will be used later in the impulse-response section.</p>
<div class="cell">
<details>
<summary>Data Initialization</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rmarkdown)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(matrixcalc)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(mvtnorm)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(parallel)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(fredr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(sovereign)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(MASS)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(fredr)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(mgcv)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(HDInterval)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(nlme)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(mgcv)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################################################################</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="st">"http://silviamirandaagrippino.com/s/DFM-Blocks.zip"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(url, <span class="st">"MAR(2020)"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unzip</span>(<span class="st">"MAR(2020)"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"GFC_VARdata+WEB.xlsx"</span>, <span class="at">skip=</span><span class="dv">1</span>, <span class="at">.name_repair =</span> <span class="st">"unique_quiet"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  inst <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"GFC_VARdata+WEB.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">2</span>, <span class="at">skip=</span><span class="dv">1</span>, <span class="at">.name_repair =</span> <span class="st">"unique_quiet"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#date = ts(seq(from = as.Date("1980-01-01"), to = as.Date("2012-12-01"), by = 'month'))</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#instrument$LABEL &lt;- date #ts object is not able to translate dates</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  gf <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"GFC_VARdata+WEB.xlsx"</span>, <span class="at">sheet=</span> <span class="dv">4</span>, <span class="at">skip=</span><span class="dv">2</span>, <span class="at">.name_repair =</span> <span class="st">"unique_quiet"</span>, <span class="at">na =</span> <span class="st">"blank"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#time series of variables </span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fed       = ts((fed[,3]), start=c(1980,1), frequency=12) #FED federal funds rate</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  instrument <span class="ot">=</span> <span class="fu">ts</span>((inst<span class="sc">$</span>FF4), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#FFF4 instrument</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  indpro     <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>INDPRO), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#industrial production</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  greaexus   <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>GREAEXUS), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Global Real Economic Activity Ex US</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  glbinflows <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>GLBINFLALL), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Global Inflows All Sectors</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  dgs1       <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>DGS1), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#1 Year Treasury Rate</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  pce        <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>PCEPI), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#PCE Deflator; </span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  bis        <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>BISREER), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#BIS real EER</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  globalf    <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>GLOBALF), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Global Factor</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  globalra   <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>GLOBALRA), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Global Risk Aversion</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  glbcrexus  <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>GLBCREXUS), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Global Domestic Credit ex US</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  usbdlev    <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>USBDLEV), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Leverage US Brokers and Dealers</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  eubdlev    <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>EUBDLEV), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Leverage EU Global Banks</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  usbanksl   <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>USBANKSL), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Leverage US Banks</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  eubanksl   <span class="ot">=</span> <span class="fu">ts</span>((data<span class="sc">$</span>EUBANKSL), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1980</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) <span class="co">#Leverage EU Banks</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create the bigy matrix with our data</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">cbind</span>(instrument,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            dgs1, </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>            (pce),</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>            (indpro),</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>            (greaexus), </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            (glbinflows),</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>            (bis), </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>            globalf, </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>            globalra,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>            (glbcrexus), </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>            (usbdlev), </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>            (eubdlev), </span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>            (usbanksl), </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>            (eubanksl))</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  y.names<span class="ot">=</span> <span class="fu">cbind</span>(<span class="st">"FF4 Instrument"</span>, </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"1Y Treasury Rate"</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"PCE"</span>, </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Industrial Production"</span>, </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Global Real Production ex US"</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Global Inflows All Sectors"</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"BIS EER"</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Global Factor"</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Global Risk Aversion"</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Global Credit ex US"</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Leverage US Brokers &amp; Dealers"</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Leverage EU Global Banks"</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Leverage US Banks"</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Leverage EU Banks"</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">#data in selected window</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    y         <span class="ot">&lt;-</span> <span class="fu">window</span>((y), <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2</span>), <span class="at">end=</span><span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Global Factors Plot</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> gf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">...1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">GLOBAL FACTOR 1975-2010</span><span class="st">`</span>, <span class="at">linetype =</span> <span class="st">"GF 1975-2010"</span>), <span class="at">color =</span><span class="st">"blue"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">linewidth=</span><span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> gf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">...1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">GLOBAL FACTOR 1990-2012</span><span class="st">`</span>, <span class="at">linetype =</span> <span class="st">"GF 1990-2012"</span>), <span class="at">color=</span><span class="st">"purple"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">linewidth=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> VIX, <span class="at">linetype =</span> <span class="st">"VIX"</span>), <span class="at">color=</span><span class="st">"black"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">linewidth=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"solid"</span>, <span class="st">"solid"</span>), </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"VIX"</span>, <span class="st">"GF 1975-2010"</span>, <span class="st">"GF 1990-2012"</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>)))) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">title =</span> <span class="st">"Global Factor for Risky Asset Prices"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">0</span>), </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-global-factors" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-global-factors-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Global Factors and VIX</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="proxy-var-analysis-with-rich-information-bayesian-var" class="level2">
<h2 class="anchored" data-anchor-id="proxy-var-analysis-with-rich-information-bayesian-var">Proxy-VAR Analysis with Rich-Information Bayesian VAR</h2>
<p>In this project, we will avoid the computation of the global factor, because it is out of scope of the Macroeconomerics subject. Instead, we will concentrate on the Bayesian VAR analysis of Miranda-Agrippino and Rey. A main reason why the authors studied the monetary effects of U.S. interest rate changes is that the dollar is the currency of global banking. A change in FED monetary policy affects banks’ borrowing capacity, the pricing of dollar denominated assets, and cross-border capital flows. In order to isolate its effects, the two scholars identify U.S. monetary policy shocks by exploiting 30-min price revisions around Federal Open Market Committee (<a href="https://www.federalreserve.gov/monetarypolicy/fomc.htm">FOMC</a>) announcements in the fourth federal funds futures contracts (<a href="https://www.investopedia.com/terms/f/fed-funds-futures.asp">FF4</a>). The intuition is that these <a href="https://www.investopedia.com/terms/f/futures.asp">futures</a> have an average maturity of three months, and they can predict revisions of market expectations about future monetary policy one-quarter in advance. This assumption holds only if market participants can distinguish between the systematic component of policy and any observable policy action. Moreover, with asymmetrical information, the FF4 revisions contain information about the influence of economic factors relevant to U.S. monetary policy. Policy announcements provide this information implicitly.</p>
</section>
</section>
<section id="the-data" class="level1">
<h1>The Data</h1>
<p>We download the data directly from the website of <a href="http://silviamirandaagrippino.com/code-data">Miranda-Agrippino</a>. The two authors study the consequences of a 1% increase in the U.S. monetary policy considering: -a domestic VAR with the effects on domestic financial markets and macroeconomic aggregates in the United States; -a global VAR with the effects on global asset markets, global domestic credit and international capital flows; -a “floaters” VAR to study if a fixed or pegged exchange rate affects the global contraction.</p>
<p>We will study the global specifications, and include the following variables:</p>
<div class="cell">
<details>
<summary>Data Plots</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################  </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>fed.gdp.plot <span class="ot">&lt;-</span>  (<span class="fu">ggplot</span>(<span class="at">data=</span>data) <span class="sc">+</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">DGS1</span><span class="st">`</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">GREAEXUS</span><span class="st">`</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dashed"</span>), <span class="at">name=</span><span class="st">""</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Global Real Economic Activity Ex US"</span>, <span class="st">"1 Year Treasury Rate"</span>), <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>)), <span class="at">nrow=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>)), <span class="at">nrow=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">title=</span> <span class="st">"Treasury Rate and Global </span><span class="sc">\n</span><span class="st">Real Activity Index"</span>) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>),<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>),  <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">11</span>), <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">axis.text =</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  pce.plot <span class="ot">&lt;-</span> (<span class="fu">ggplot</span>(<span class="at">data=</span>data) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> PCEPI, <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>), <span class="at">name=</span><span class="st">""</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"PCE Deflator"</span>), <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>)))) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>     <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>)))) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">title=</span> <span class="st">"Price Deflator"</span>) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>, <span class="at">face=</span><span class="st">"bold"</span>),  <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  leverage.plot <span class="ot">&lt;-</span>  (<span class="fu">ggplot</span>(<span class="at">data=</span>data) <span class="sc">+</span> </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> EUBDLEV, <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span> </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> USBANKSL, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span> </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> EUBANKSL, <span class="at">linetype =</span> <span class="st">"twodash"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> USBDLEV, <span class="at">linetype =</span> <span class="st">"dotted"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"violet"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dashed"</span>, <span class="st">"twodash"</span>, <span class="st">"dotted"</span>), <span class="at">name=</span><span class="st">""</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Leverage EU Banks"</span>, <span class="st">"Leverage EU Global Banks"</span>, <span class="st">"Leverage US Banks"</span>, <span class="st">"Leverage US Brokers and Dealers"</span>), <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"purple"</span>, <span class="st">"violet"</span>)))) <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>, <span class="st">"violet"</span>)))) <span class="sc">+</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">title=</span> <span class="st">"Leverage"</span>) <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>, <span class="at">face=</span><span class="st">"bold"</span>),  <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)))</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  mixed.types.plot <span class="ot">&lt;-</span>   (<span class="fu">ggplot</span>(<span class="at">data=</span>data) <span class="sc">+</span> </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> GLBINFLALL, <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span> </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> INDPRO, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span> </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> GLBCREDIT, <span class="at">linetype =</span> <span class="st">"twodash"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> BISREER, <span class="at">linetype =</span> <span class="st">"dotted"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"violet"</span>, <span class="at">linewidth=</span><span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dashed"</span>, <span class="st">"twodash"</span>, <span class="st">"dotted"</span>), <span class="at">name=</span><span class="st">""</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Industrial Production"</span>,<span class="st">"Global Inflows All Sectors"</span>, <span class="st">"Global Domestic Credit"</span>, <span class="st">"BIS real EER"</span>), <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"purple"</span>, <span class="st">"violet"</span>)))) <span class="sc">+</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>     <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>, <span class="st">"violet"</span>)))) <span class="sc">+</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">title=</span> <span class="st">"Production, Inflows, Credit, BIS REER"</span>) <span class="sc">+</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>),<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>, <span class="at">face=</span><span class="st">"bold"</span>),  <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)))</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  risk.types.plot <span class="ot">&lt;-</span>  (<span class="fu">ggplot</span>(<span class="at">data=</span>data) <span class="sc">+</span> </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> GLOBALF, <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">LABEL</span><span class="st">`</span>, <span class="at">y =</span> GLOBALRA, <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"solid"</span>, <span class="st">"dashed"</span>), <span class="at">name=</span><span class="st">""</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Global Risk Aversion"</span>, <span class="st">"Global Factor"</span>), <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"blue"</span>)), <span class="at">nrow=</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span><span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">title=</span> <span class="st">"Risk Aversion"</span>) <span class="sc">+</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">9</span>),<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>, <span class="at">face=</span><span class="st">"bold"</span>),  <span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)))</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  combinedplot<span class="fl">.1</span> <span class="ot">&lt;-</span> mixed.types.plot <span class="sc">/</span> leverage.plot </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  combinedplot<span class="fl">.2</span> <span class="ot">&lt;-</span> fed.gdp.plot <span class="sc">+</span> risk.types.plot <span class="sc">+</span> pce.plot</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  combinedplot<span class="fl">.1</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  combinedplot<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-data-plots1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-data-plots1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Data plots</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-data-plots1-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-data-plots1-2.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Data plots</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">Data Description</h2>
<p>Against this framework, our interest is to study the degree by which U.S. monetary policy shocks can propagate throughout the world’s economies. In order to have a global picture we study macroeconomic variables that can affect and influence a FED change in the interest rate. The global variables are constructed by scrutinizing these countries: Argentina, Australia, Austria, Belarus, Belgium, Bolivia, Brazil, Bulgaria, Canada, Chile, Colombia, Costa Rica, Croatia, Cyprus, Czech Republic, Denmark, Ecuador, Finland, France, Germany, Greece, Hong Kong, Hungary, Iceland, Indonesia, Ireland, Italy, Japan, Latvia, Lithuania, Luxembourg, Malaysia, Malta, Mexico, Netherlands, New Zealand, Norway, Poland, Portugal, Romania, Russia, Serbia, Singapore, Slovakia, Slovenia, South Africa, South Korea, Spain, Sweden, Switzerland, Thailand, Turkey, U.K., and the U.S.</p>
<p>As discussed in the previous section, we are including the variables of the global VAR of <span class="citation" data-cites="miranda2020us">Miranda-Agrippino and Rey (<a href="#ref-miranda2020us" role="doc-biblioref">2020</a>)</span>. In the first graph, we include the following variables: the U.S. industrial production index that measures the real output of all relevant establishments located in the U.S.; the Bank for International Settlement (BIS) effective exchange rate (EER) for the United States, i.e.&nbsp;a summary measure calculated by the BIS to account for changes in the U.S. bilateral exchange rate against other countries by their trade importance; global inflows, defined as direct cross-border credit flows from the U.S. to the aforementioned countries’ banks and non-bank recipients. This variable is key to explaining the degree of financial dependency of the rest of the world vis-à-vis the financial hegemon; global domestic credit, another key variable in our VAR that outlines the total amount of funds in the world economy, including loans, debt instruments, and other forms of credit provided by financial institutions.</p>
<p>In the second graph, we outline four types of leverage. First of all, leverage can be defined as the ratio between assets and equity, with equity being the difference between assets and debts. In finance, this measurement refers to the use of borrowed funds to finance assets or investments. Against this backdrop, the authors construct this variable as the ratio between claims in the private sector, i.e.&nbsp;credit extended by banks and other financial institutions to the private sector, and the sum of transferable deposits held by depository corporations, excluding central banks. This ratio reflects the proportion of credit extended to the private sector relative to deposits held by depository corporations, excluding central banks. A higher ratio suggests a higher banking leverage level. The authors differentiate between different leverages given financial agents’ risk-taking behavior. As a matter of fact, we can observe that the leverage between EU global banks and US brokers and dealers is much larger than the leverage of big but not systemic EU and US banks. EU global banks include systematically important banks such as UBS and Unicredit. Global banks’ leverage is high for several reasons such as size and risk appetite. Brokers and dealers’ behavior can be explained by their risk-loving approach.</p>
<p>In the third graph, we include the FED policy rate coupled with the global real economic activity index (excluding the US). We can observe the lag effect of an increase in interest rates with a decrease in international economic activity. In the fourth graph we include the global factor discussed in the previous section, plotted with global risk aversion (one variable is the inverse of the other). The factor is rotated to provide an intuitive view that an increase in the factor (risk aversion) reflects an increase in world asset prices. Lastly, we plot the U.S. PCE deflator to measure changes in goods and services prices over time.</p>
<p>Lastly, we will add the aforementioned instrument on top of the <span class="math inline">\(y_t\)</span> variable. In the next section we will provide the reason for this procedure.</p>
</section>
<section id="order-of-integration-of-the-variables" class="level2">
<h2 class="anchored" data-anchor-id="order-of-integration-of-the-variables">Order of Integration of the Variables</h2>
<p>We run an augmented Dickey Fuller (ADF) test to determine the order of integration of our variables. The test rejects the null hypothesis that the variables are unit-root except for our instrument variable as expected. In order to provide more insight into the order of integration we re-run an ADF test with the first difference of the variables.</p>
<div class="cell">
<details>
<summary>ADF-tests</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tseries)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  adf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">14</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="cn">NA</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(adf) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>])</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(adf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dickey-Fuller"</span>,<span class="st">"Lag"</span>, <span class="st">"p-value"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(y)){</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    adf_tmp                 <span class="ot">&lt;-</span>  <span class="fu">adf.test</span>(y[,i])</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    adf[i,<span class="st">"Dickey-Fuller"</span>]  <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">as.numeric</span>(adf_tmp[<span class="dv">1</span>]),<span class="dv">3</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    adf[i,<span class="st">"Lag"</span>]      <span class="ot">&lt;-</span>  <span class="fu">as.numeric</span>(adf_tmp[<span class="dv">2</span>])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    adf[i,<span class="st">"p-value"</span>]        <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">as.numeric</span>(adf_tmp[<span class="dv">4</span>]),<span class="dv">3</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  adf.diff <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">14</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="cn">NA</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(adf.diff) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>])</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(adf.diff) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dickey-Fuller diff"</span>,<span class="st">"Lag diff"</span>, <span class="st">"p-value diff"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">ncol</span>(y)){</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    tmp.diff                         <span class="ot">&lt;-</span>  <span class="fu">adf.test</span>(<span class="fu">diff</span>(y[,i]))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    adf.diff[i,<span class="st">"Dickey-Fuller diff"</span>] <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">as.numeric</span>(tmp.diff[<span class="dv">1</span>]),<span class="dv">3</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    adf.diff[i,<span class="st">"Lag diff"</span>]     <span class="ot">&lt;-</span>  <span class="fu">as.numeric</span>(tmp.diff[<span class="dv">2</span>])</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    adf.diff[i,<span class="st">"p-value diff"</span>]       <span class="ot">&lt;-</span>  <span class="fu">round</span>(<span class="fu">as.numeric</span>(tmp.diff[<span class="dv">4</span>]),<span class="dv">3</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">t</span>(y.names),adf, adf.diff)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(tab)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"Variable Names"</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(tab, <span class="at">index=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-ADF" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;1: ADF Tests</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable Names</th>
<th style="text-align: right;">Dickey-Fuller</th>
<th style="text-align: right;">Lag</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Dickey-Fuller diff</th>
<th style="text-align: right;">Lag diff</th>
<th style="text-align: right;">p-value diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FF4 Instrument</td>
<td style="text-align: right;">-4.492</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">-10.666</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">1Y Treasury Rate</td>
<td style="text-align: right;">-2.612</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.318</td>
<td style="text-align: right;">-4.047</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PCE</td>
<td style="text-align: right;">-2.349</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.429</td>
<td style="text-align: right;">-6.200</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Industrial Production</td>
<td style="text-align: right;">-1.692</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.706</td>
<td style="text-align: right;">-4.354</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Global Real Production ex US</td>
<td style="text-align: right;">-3.305</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">-5.053</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Global Inflows All Sectors</td>
<td style="text-align: right;">-2.032</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">-4.474</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIS EER</td>
<td style="text-align: right;">-1.425</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.818</td>
<td style="text-align: right;">-7.129</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Global Factor</td>
<td style="text-align: right;">-2.031</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">-7.166</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Global Risk Aversion</td>
<td style="text-align: right;">-1.857</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">-6.564</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Global Credit ex US</td>
<td style="text-align: right;">-1.520</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">-5.558</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leverage US Brokers &amp; Dealers</td>
<td style="text-align: right;">-2.699</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.282</td>
<td style="text-align: right;">-5.411</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leverage EU Global Banks</td>
<td style="text-align: right;">-3.276</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">-5.696</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leverage US Banks</td>
<td style="text-align: right;">-1.529</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">-5.348</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leverage EU Banks</td>
<td style="text-align: right;">-1.637</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">-6.037</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="the-model" class="level1">
<h1>The Model</h1>
<section id="bvar-framework" class="level2">
<h2 class="anchored" data-anchor-id="bvar-framework">BVAR Framework</h2>
<p>From <span class="citation" data-cites="HRW2022ProxySVARs">Herwartz (<a href="#ref-HRW2022ProxySVARs" role="doc-biblioref">2021</a>)</span> we define the model as: <span class="math display">\[
y_t=B_0B_1y_{t-1}+...+B_0B_py_{t-p}+B_0\varepsilon_t, t=1,..,T \]</span> <span class="math display">\[y_t=A_1y_{t-1}+...+A_py_{t-p}+u_t\]</span> where <span class="math inline">\(A_j, : \left \{j=1,2,\dots,p\right \}\)</span> where <span class="math inline">\(A(L)=B_0B(L)\)</span> are a K x K coefficient matrices, and L is the lag operator, and <span class="math inline">\(u_t\)</span> in the first reduced form is serially uncorrelated with zero mean and positive definite (non-diagonal) covariance matrix <span class="math inline">\(\Sigma_u.\)</span> The structural shocks <span class="math inline">\(\varepsilon_t\)</span> in the second reduced form are assumed to be mutually uncorrelated and normalised to have unit variance. <span class="math inline">\(\Xi\left(\varepsilon_t \varepsilon_t' \right)=I_K\)</span>. Structural shocks are mapped to the reduced-form system through a K x K non-singular matrix <span class="math inline">\(B_0\)</span>, such that <span class="math inline">\(B_0^{-1}B_0^{-1'}=\Sigma_u\)</span>. For simplicity, the process is assumed to be causal and <span class="math inline">\(\det A(z)=\det(I_k-\sum_{j=1}^{p}A_jz^{j})\neq 0\)</span> for <span class="math inline">\(\left| z \right|\le 1\)</span>. This ensures that the process has a Wold moving average MA representation. Moreover,</p>
<span class="math display">\[\begin{align*}
y_t=\mu+\sum_{i=0}^{\infty}\Phi_iu_{t-i}=\mu+\sum_{i=0}^{\infty}\Phi_iB_0\varepsilon_{t-i}=
\mu+\sum_{i=0}^{\infty}\Theta_i\varepsilon_{t-i}.
\end{align*}\]</span>
<p>With: <span class="math display">\[\begin{gather}
\mu=A(1)^{-1}\nu, ::: \Phi_0=I_K, \ \Phi_i=\sum_{j=1}^{i}A_j\Phi_{i-j}, ::: A_j=0 :for: j&gt;p.
\end{gather}\]</span> The second to last MA representation is of particular importance because the structural MA coefficients <span class="math inline">\(\Theta_i=\Phi_iB_0\)</span> cannot be recovered without a proper identification. We will briefly outline the Proxy SVAR approach.</p>
<p>Let <span class="math inline">\(z_t\)</span> be an external instrument to identify the structural shock of interest <span class="math inline">\(\varepsilon_{kt}, k\:\epsilon \: \left \{1,\dots, K\right \}\)</span>. <span class="math inline">\(z_t\)</span> has to satisfy the <em>relevant</em> condition <span class="math inline">\(\Xi(\varepsilon_{kt}z_t)=\phi \neq 0\)</span> and the <em>exogeneity</em> condition <span class="math inline">\(\Xi(\varepsilon{lt}z_t)=0, \forall l\:\epsilon\left \{1,\dots, K\right \}\setminus\left \{k\right \}\)</span>.</p>
<p>From these conditions, it follows that the population covariance between the instrument and VAR residuals obtain the k-th column if <span class="math inline">\(B_0\)</span>, denoted by <span class="math inline">\(B_{0k}\)</span>. \end{gather} The second to last MA representation is of particular importance because the structural MA coefficients <span class="math inline">\(\Theta_i=\Phi_iB_0\)</span> cannot be recovered without a proper identification. We will briefly outline the Proxy SVAR approach. Let <span class="math inline">\(z_t\)</span> be an external instrument to identify the structural shock of interest <span class="math inline">\(\varepsilon_{kt}, k\:\epsilon \: \left \{1,\dots, K\right \}\)</span>. <span class="math inline">\(z_t\)</span> has to satisfy the <em>relevant</em> condition <span class="math inline">\(\Xi(\varepsilon_{kt}z_t)=\phi \neq 0\)</span> and the <em>exogeneity</em> condition <span class="math inline">\(\Xi(\varepsilon{lt}z_t)=0, \forall l\:\epsilon\left \{1,\dots, K\right \}\setminus\left \{k\right \}\)</span>. From these conditions, it follows that the population covariance between the instrument and VAR residuals obtains the k-th column of <span class="math inline">\(B_0\)</span>, denoted by <span class="math inline">\(B_{0k}\)</span>.</p>
<p><span class="math display">\[
\Xi(u_tz_t) = B_{0,k} \\
\Xi(\varepsilon{kt}z_t)=\phi B_{0,k}
\]</span> Moreover, let <span class="math inline">\(\Pi\)</span> denotes the <span class="math inline">\(1\)</span>x<span class="math inline">\(K\)</span> coefficient vector from the regression of the instrument on the residual vector <span class="math inline">\(u_t\)</span> gives the shock <span class="math inline">\(\varepsilon_{kt}\)</span> up to a scale <span class="math inline">\(\phi\)</span>. <span class="math inline">\(\Pi u_t=\Xi(z_tu^{'}_t)\Sigma_{u}^{-1}u_t=\phi B^{'}_{0,k}\left [B_0B_0^{'} \right ]u_t=\phi e^{'}_t\varepsilon_{kt}\)</span> <span class="citation" data-cites="MollerWolf2021LPVARS">Plagborg-Moller (<a href="#ref-MollerWolf2021LPVARS" role="doc-biblioref">2021</a>)</span>, exploiting their result that Local Projections and VAR impulse response function are equal up to a constant of proportionality, show that proxy SVARS impulse responses can be computed putting the instrument in the first row of the data vector <span class="math inline">\(y_t\)</span> in a SVAR framework. This result follows from the invertibility of <span class="math inline">\(\varepsilon\)</span> and two assumptions: -the data <span class="math inline">\(y_t\)</span> is covariance-stationary; -the data <span class="math inline">\(y_t\)</span> is a jointly Gaussian vector time series.</p>
<p>In our Bayesian approach these requirements are met when we define the distributions of our error terms and prior specifications. We will outline them in the next section.</p>
</section>
<section id="basic-model" class="level2">
<h2 class="anchored" data-anchor-id="basic-model">Basic Model</h2>
<p>We specify our model to follow a matrix-variate normal distribution <span class="math display">\[\begin{gather}
Y = XA + E \\
\\ E|X \sim MN_{T \times N}(0_{T \times N},\Sigma,I_T)
\end{gather}\]</span> Given that the function Y is a linear combination of the error terms E, we can specify <span class="math display">\[\begin{gather}
Y|X,A,\sim MN_{T \times N}(XA,\Sigma,I_T)
\end{gather}\]</span> Hence, the Likelihood function follows a Matrix-Variate-Normal form: <span class="math display">\[\begin{gather}
L(A,\Sigma|Y,X) \propto \det(\Sigma)^{-\frac{T}{2}} exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-XA)'(Y-XA) \right] \right\} \\
\\ \propto \det(\Sigma)^{-\frac{T}{2}} exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(A-\hat{A}) \right] \right\} exp \left\{-\frac{1}{2} tr \left[\Sigma^{-1}(Y-X \hat{A})'(Y-X \hat{A}) \right] \right\} \\
\end{gather}\]</span> where from Maximum Likelihood Estimation we have obtained <span class="math display">\[\begin{gather}
\hat{A} = (X'X)^{-1}X'Y \\
\\ \hat{\Sigma} = \frac{1}{T} (Y-X \hat{A})'(Y-X \hat{A})
\end{gather}\]</span> In the basic model, our prior follows a natural-conjugate prior distribution of the same form: <span class="math display">\[\begin{gather}
p(A,\Sigma) = p(A|\Sigma) p(\Sigma) \\
\\ A|\Sigma \sim MN_{K \times N} (\underline{A}, \Sigma , \underline{V}) \\
\\ \Sigma \sim IW_{N}(\underline{S},\underline{\nu})
\end{gather}\]</span></p>
<p>With parameters: <span class="math display">\[\begin{gather}
\underline{A} = [0_{N \times 1} \quad I_N \quad 0_{N \times (p-1)N}]' \\
\\ Var[vec(A)] = \Sigma \otimes  \underline{V} \\
\\ \underline{V} = diag([\kappa_2 \quad \kappa_1 (p^{-2} \otimes I_N)]) \\
\\ p = [1,2,...p]
\end{gather}\]</span> <span class="math inline">\(\kappa_2\)</span> and <span class="math inline">\(\kappa_1\)</span> describe, respectively, the priors of the overall shrinkage level of the constant term and the variance-covariance matrix of the autoregressive slopes for the constant term. We specify <span class="math inline">\(\kappa_2=1\)</span> and <span class="math inline">\(\kappa_1=0.02\)</span> to respect <span class="citation" data-cites="MollerWolf2021LPVARS">Plagborg-Moller (<a href="#ref-MollerWolf2021LPVARS" role="doc-biblioref">2021</a>)</span> assumptions. We would not expect persistence in each lag for stationary variables following a random walk. Moreover, we set the prior of the autoregressive parameters <span class="math inline">\(A\)</span> equal to a vector of zeros. The resulting full conditional posterior is: <span class="math display">\[\begin{gather}
p(A,\Sigma|Y,X) = p(A|Y,X,\Sigma)p(\Sigma|Y,X) \\
\\ p(A|Y,X,\Sigma) = MN_{K \times N}(\bar{A}, \Sigma, \bar{V}) \\
\\ p(\Sigma | Y, X) = IW_N(\bar{S},\bar{\nu})
\end{gather}\]</span></p>
<p>We can derive the full conditional posterior: <span class="math display">\[\begin{gather}
P(A,\Sigma|Y,X) \propto L(A,\Sigma|Y,X)p(A,\Sigma) \\
\\ \propto L(A,\Sigma|Y,X)p(A|\Sigma)p(\Sigma) \\
\\ \det(\Sigma)^{-\frac{T}{2}} \times exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})' X'X (A-\hat{A})\right] \right\} \\
\\ \times exp\left\{-\frac{1}{2}tr \left[ \Sigma^{-1}(Y-X\hat{A})'(Y-X\hat{A}) \right] \right\} \\
\\ \times \det(\Sigma)^{-\frac{N+K+\underline{\nu}+1}{2}} \\
\\ \times exp\left\{-\frac{1}{2}tr \left[ \Sigma^{-1}(A- \underline{A})'\underline{V}^{-1}(A- \underline{A}) \right] \right\} \\
\\ \times exp \left\{ -\frac{1}{2} tr \left[ \Sigma^{-1} \underline{S} \right] \right\}
\end{gather}\]</span></p>
<p>After some calculations:</p>
<span class="math display">\[\begin{gather}\\
p(A,\Sigma|Y,X) \propto \\
\\ \det{(\Sigma)}^{-\frac{T+N+K+ \underline{\nu}
+1}{2}} \times exp\left\{ -\frac{1}{2} tr \left[ \Sigma^{-1} \left[ (A-\bar{A})^{'} \bar{V}^{-1} (A-\bar{A})+\underline{S} +Y^{'}Y + \underline{A}^{'} \underline{V}^{-1}\underline{A} -\bar{A}^{'} \bar{V}^{-1}\bar{A}\right]\right]\right\}
\end{gather}\]</span>
<p>where the full conditional posterior has the same natural-conjugate form of our prior:</p>
<span class="math display">\[\begin{gather}
p(A,\Sigma|Y,X) = p(A|Y,X,\Sigma)p(\Sigma|Y,X) \\
\\ p(A|Y,X,\Sigma) = MN_{K \times N}(\bar{A}, \Sigma, \bar{V}) \\
\\ p(\Sigma | Y, X) = IW_N(\bar{S},\bar{\nu})\end{gather}\]</span>
<p>with posterior parameters:</p>
<span class="math display">\[\begin{gather}
\bar{V} = (X^{'}X+ \underline{V}^{-1})^{-1} \\
\\ \bar{A} = \bar{V}(X^{'}Y+\underline{V}^{-1} \underline{A}) \\
\\ \bar{\nu} = T + \underline{\nu} \\
\\ \bar{S} = \underline{S} + Y^{'}Y +  \underline{A}^{'}\underline{V}^{-1}\underline{A} - \bar{A}^{'}\bar{V}^{-1}\bar{A}
\end{gather}\]</span>
<p>In order to compute our posterior parameters in R, we first specify values for our priors, then calculate the posteriors and draw <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span> respectively from Matrix-Variate-normal and Inverse Wishart distributions. At this point, we can obtain our structural parameters through a Cholesky decomposition of our matrix <span class="math inline">\(\Sigma\)</span>, namely with <span class="math inline">\(\Sigma^{-1}=(B_0B_0^{'})\)</span>.</p>
<div class="cell">
<details>
<summary>Basic Model Function</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  basic.model <span class="ot">&lt;-</span> <span class="cf">function</span>(bigy, p, S, start, end){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  N       <span class="ot">=</span> <span class="fu">ncol</span>(bigy)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  K       <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  Y       <span class="ot">=</span> bigy[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(bigy),]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  X       <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(Y),<span class="dv">1</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    X     <span class="ot">=</span> <span class="fu">cbind</span>(X,bigy[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(bigy)<span class="sc">-</span>i,])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  A.prior     <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,K,N)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  A.prior[<span class="dv">2</span><span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>),] <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">rep</span>(<span class="dv">1</span>,N<span class="dv">-1</span>))) <span class="co">#0 for the instrument (stationary variable)</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  V.prior     <span class="ot">=</span> (<span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.02</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))) <span class="co">#1 is kappa.2, 0.02 is kappa.1</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  S.prior     <span class="ot">=</span> <span class="fu">diag</span>(N)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  nu.prior    <span class="ot">=</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normal-inverse Wishart posterior parameters</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior)) <span class="co">#X'X+diag(V^-1)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  V.bar       <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv) <span class="co">#inv(X'X+diag(V^-1))</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  A.bar       <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  nu.bar      <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  S.bar       <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># posterior draws</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior   <span class="ot">=</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior,<span class="dv">3</span>,solve)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior,<span class="fu">c</span>(N,N,S))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S)) <span class="co">#3 dimensional, S repetitions of rnorm</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  B.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  L                 <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    cholSigma.s     <span class="ot">=</span> <span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    B.posterior[,,s]<span class="ot">=</span> <span class="fu">t</span>(cholSigma.s)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s]<span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span>cholSigma.s</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return the parameters of interest</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"B"</span> <span class="ot">=</span> B.posterior, <span class="st">"A"</span> <span class="ot">=</span> A.posterior, <span class="st">"Sigma"</span> <span class="ot">=</span> Sigma.posterior)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="extended-model" class="level2">
<h2 class="anchored" data-anchor-id="extended-model">Extended Model</h2>
<p>In the extended model, we set hyperprior parameters for the autoregressive parameter <span class="math inline">\(\kappa_A\)</span> to follow an Inverse Gamma 2 distribution <span class="math inline">\(IG2(\underline{S}_{\kappa},\underline{\nu}_{\kappa})\)</span> and <span class="math inline">\(\kappa_{\Sigma}\)</span> hyperprior parameter for the variance-covariance matrix to follow a Gamma Distribution <span class="math inline">\(G(\underline{S}_{\Sigma},\underline{a}_{\Sigma})\)</span>. We define a hierarchical model to provide flexibility to our model and hopefully reduce uncertainty. We will define the full conditional posterior of the hyperparameter <span class="math inline">\(\kappa_A\)</span> first.</p>
<span class="math display">\[\begin{gather}
p(\kappa_A | A,\Sigma, Y,X) \propto L(Y|X,A,\Sigma) \times p(\kappa_A) \times p(A|\Sigma,\kappa_A) \times p(\Sigma|\kappa_A) \\
\\ \propto p(\kappa_A) \times p(A|\Sigma,\kappa_A) \\
\\ \propto (\kappa_A)^{-\frac{\underline{\nu_a}_{\kappa_A}+2}{2}}
exp\left\{ -\frac{1}{2} \frac{\underline{s_a}}{\kappa_A} \right\}  \times exp\left\{-\frac{1}{2}tr\left[\Sigma^{-1}(A-\underline{A})^{'} \frac{1}{\kappa}(\underline{V_{\kappa}})^{-1} (A-\underline{A})\right]\right\} \times \det(\kappa_A \underline{V})^{-\frac{N}{2}} \\
\\ \propto (\kappa_A)^{-\frac{\underline{\nu_a}_{\kappa_A}+2+NK}{2}} exp \left\{-\frac{1}{2} \frac{1}{\kappa_A} \left[\underline{s_a}_{\kappa_A} + tr \left[\Sigma^{-1}(A-\underline{A})^{'}\underline{V}^{-1}(A-\underline{A}) \right]\right] \right\}
\end{gather}\]</span>
<p>where we recognise the kernel of an Inverse Gamma 2 Distribution with</p>
<span class="math display">\[\begin{gather}
\bar{s}_a = \underline{s}_a+tr \left[ \Sigma^{-1} (A-\underline{A})^{'} \underline{V}^{-1} (A-\underline{A})\right] \\
\\ \bar{\nu}_a = \underline{\nu}_a+NK
\end{gather}\]</span>
<p>In addition, we obtain a similar full conditional posterior of the hyperparameter <span class="math inline">\(\kappa_{\Sigma}\)</span>. <span class="math display">\[\begin{gather}
p(\kappa_{\Sigma} | A,\Sigma, Y,X) \propto L(Y|X,A,\Sigma) \times p(\kappa_{\Sigma}) \times p(A|\Sigma,\kappa_A) \times p(\Sigma|\kappa_{\Sigma}) \times p(\kappa_A) \\
\\ \propto p(\kappa_{\Sigma}) \times p(\Sigma|\kappa_{\Sigma}) \\
\\ \propto (\kappa_{\Sigma})^{-\frac{\underline{\nu}N}{2}}
exp\left[{ -\frac{1}{2} \frac{\kappa_{\Sigma}}{tr\left [\Sigma^{-1}\underline{s}_{\Sigma} \right ]^{-1}}} \right\}  \times (\kappa_{\Sigma})^{\underline{a}_{\Sigma}-1}exp\left [{-\frac{\kappa_{\Sigma}}{\underline{s}_{\Sigma}}}  \right ] \\
\\ \propto (\kappa_{\Sigma})^\frac{{}{N\underline{\nu}+2\underline{a}_{\Sigma}-2}}{2}exp\left [{-\frac{\kappa_{\Sigma}}{\left [2tr\left[\Sigma^{-1}\underline{s}_{\Sigma} \right ]^{-1}+\left[\underline{s}_{\Sigma} \right ]^{-1}\right ]^{-1}}}  \right ] \\
\end{gather}\]</span> where we can recognise the kernel of an Gamma Distribution with <span class="math display">\[\begin{gather}
\bar{s}_{\Sigma} = {\left [2\left[tr\Sigma^{-1}\underline{s}_{\Sigma} \right ]^{-1}+\left[\underline{s}_{\Sigma} \right ]^{-1}\right ]^{-1}} \\
\\ \bar{a}_{\Sigma} = \frac{N\underline{\nu}}{2}+\underline{a}_{\Sigma}
\end{gather}\]</span></p>
<p>Therefore, our new full conditional posterior distribution will be as follows: <span class="math display">\[\begin{gather}
p(A,\Sigma|X,Y,\kappa_A,\kappa_{\Sigma}) \propto L(A,\Sigma|Y,X) \times p(A|\Sigma,\kappa_A) \times p(\Sigma|\kappa_{\Sigma}) \\
\\ \propto \det(\Sigma)^{-\frac{K}{2}} exp \left\{-\frac{1}{2}tr \left[ \Sigma^{-1}(Y-XA)^{'}(Y-XA)\right] \right\} \\
\\ \times exp \left\{ -\frac{1}{2} tr \left[ \Sigma^{-1}(A-\underline{A})^{'}(\kappa_A \underline{V})^{-1}(A-\underline{A}) \right] \right\} \\
\\ \times \det(\Sigma)^{\frac{\underline{\nu}+N+1}{2}} exp\left\{-\frac{1}{2} tr \left[\Sigma^{-1}\kappa_{\Sigma} \right] \right\}
\end{gather}\]</span></p>
<p>We recognize the kernel of a matrix-normal inverse Wishart distribution, with parameters as follows: <span class="math display">\[\begin{gather}
\bar{V} = (X'X+(\kappa_A \underline{V}))^{-1} \\
\\ \bar{A} = \bar{V}(X'Y+(\kappa_A \underline{V}^{-1}\underline{A})) \\ \\ \bar{S} = I_N\kappa_{\Sigma}+Y'Y+\underline{A}^{'}(\kappa_A \underline{V})^{-1}\underline{A} - \bar{A}^{'} \bar{V}^{-1}\bar{A} \\
\\ \bar{\nu} = T + \underline{\nu}
\end{gather}\]</span></p>
</section>
<section id="gibbs-sampler" class="level2">
<h2 class="anchored" data-anchor-id="gibbs-sampler">Gibbs Sampler</h2>
<p>In order to reach our analytical solutions we use a Monte Carlo Markov Chain (MCMC) method, namely the Gibbs Sampler procedure. We generate random draws from the joint posterior distribution and update them at each iteration to compute our posterior distribution parameters. In our case we exploit the following procedure: initialize <span class="math inline">\(\kappa_A\)</span> and <span class="math inline">\(\kappa_{\Sigma}\)</span> at <span class="math inline">\(\kappa_A^{(0)}\)</span> and <span class="math inline">\(\kappa^{(0)}_{\Sigma}\)</span>.</p>
<p>At each iteration i:</p>
<ol type="1">
<li>Draw <span class="math inline">\((A,\Sigma)^{(i)} \sim p(A,\Sigma\| X,Y,\kappa_A^{(i-1)}, \kappa_{\Sigma}^{(i-1)})\)</span></li>
<li>Draw <span class="math inline">\(\kappa_A^{(i)} \sim p(\kappa_A|Y,X,A,\Sigma)\)</span></li>
<li>Draw <span class="math inline">\(\kappa_{\Sigma}^{(i)} \sim p(\kappa_{\Sigma}|Y,X,A,\Sigma)\)</span></li>
</ol>
<p>Repeat steps 1 and 2 for <span class="math inline">\((S_1 + S_2)\)</span> times. Discard the first <span class="math inline">\(S_1\)</span> repetitions. Return the output as <span class="math inline">\(\left \{ A^{(i)}, \Sigma^{(i)} \right \}^{S_2}_{i=S_1+1}\)</span>.</p>
<div class="cell">
<details>
<summary>Extended Model Function 2</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>extended.model <span class="ot">&lt;-</span> <span class="cf">function</span>(bigy, p, S1, S2){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  Y       <span class="ot">=</span> bigy[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(bigy),]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  X       <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(Y),<span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    X     <span class="ot">=</span> <span class="fu">cbind</span>(X,bigy[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(bigy)<span class="sc">-</span>i,])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  N       <span class="ot">=</span> <span class="fu">ncol</span>(bigy)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  K       <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  S<span class="ot">=</span>S1<span class="sc">+</span>S2 <span class="co">#sum of replications</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set the priors</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  A.prior     <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,K,N) <span class="co">#try to put is as 0</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#A.prior[2:(N+1),] &lt;- diag(c(0,rep(1,N-1)))</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  V.prior         <span class="ot">=</span> (<span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.02</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))) <span class="co">#1 is kappa.2, 0.02 is kappa.1</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  nu.prior        <span class="ot">=</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#kappa.a priors</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  nu.a.prior      <span class="ot">=</span> <span class="dv">200</span>    <span class="co">#ig2</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  s.a.prior       <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#kappa.sigma priors</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  a.sigma.prior   <span class="ot">=</span> <span class="dv">1</span>  <span class="co">#rgamma</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  s.sigma.prior   <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  A.posterior         <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(K,N,S))), <span class="fu">c</span>(K, N, S))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  B.posterior         <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  Sigma.post          <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  k.sigma             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S, <span class="dv">1</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  k.a                 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S, <span class="dv">1</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  k.sigma[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  k.a[<span class="dv">1</span>]     <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  nu.bar      <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  nu.bar.a    <span class="ot">=</span> nu.a.prior <span class="sc">+</span> N<span class="sc">*</span>K</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  a.sigma.bar <span class="ot">=</span> (N<span class="sc">*</span>nu.prior)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>a.sigma.prior</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S) {</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># normal-inverse Wishart, IG2, and Gamma posterior parameters</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="do">############################################################</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> (k.a[s]<span class="sc">^-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    V.bar       <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    A.bar       <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(k.a[s]<span class="sc">*</span>V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    S.bar       <span class="ot">=</span> k.sigma[s]<span class="sc">*</span><span class="fu">diag</span>(N) <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(k.a[s]<span class="sc">*</span>V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posterior draws</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="do">############################################################</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior.inv <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior     <span class="ot">=</span> <span class="fu">solve</span>(Sigma.posterior.inv[,,<span class="dv">1</span>])</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    L                   <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    cholSigma.s         <span class="ot">=</span> <span class="fu">chol</span>(Sigma.posterior)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    A.posterior[,,s]    <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span>cholSigma.s</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    s.a.bar       <span class="ot">&lt;-</span> s.a.prior <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">diag</span>(Sigma.posterior.inv[,,<span class="dv">1</span>] <span class="sc">%*%</span> <span class="fu">t</span>(A.posterior[,,s]<span class="sc">-</span>A.prior)<span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior)) <span class="sc">%*%</span> (A.posterior[,,s]<span class="sc">-</span>A.prior)))</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    s.sigma.bar   <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>(<span class="fu">diag</span>(Sigma.posterior.inv[,,<span class="dv">1</span>]))<span class="sc">^-</span><span class="dv">1</span>)<span class="sc">+</span>((s.sigma.prior)<span class="sc">^-</span><span class="dv">1</span>))<span class="sc">^-</span><span class="dv">1</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">&lt;=</span> S){</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>      <span class="co">#draw k.a from IG2</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>      k.a[s<span class="sc">+</span><span class="dv">1</span>]      <span class="ot">&lt;-</span> s.a.bar <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar.a)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>      <span class="co">#draw k.sigma from gamma distribution</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>      k.sigma[s<span class="sc">+</span><span class="dv">1</span>]  <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1</span>, <span class="at">shape =</span> a.sigma.bar, <span class="at">scale =</span> s.sigma.bar)</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    B.posterior[,,s]  <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(Sigma.posterior))</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    Sigma.post[,,s]   <span class="ot">=</span> Sigma.posterior</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return the parameters of interest</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"B"</span> <span class="ot">=</span> B.posterior[,,S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"A"</span> <span class="ot">=</span> A.posterior[,,S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Sigma"</span> <span class="ot">=</span> Sigma.post[,,S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.a"</span> <span class="ot">=</span> k.a[S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.sigma"</span> <span class="ot">=</span> k.sigma[S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"B.convergence"</span> <span class="ot">=</span> B.posterior[,,<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"A.convergence"</span> <span class="ot">=</span> A.posterior[,,<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Sigma.convergence"</span> <span class="ot">=</span> Sigma.post[,,<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.a.convergence"</span> <span class="ot">=</span> k.a[<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.sigma.convergence"</span> <span class="ot">=</span> k.sigma[<span class="dv">1</span><span class="sc">:</span>S])</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="stochastic-volatility-extension" class="level2">
<h2 class="anchored" data-anchor-id="stochastic-volatility-extension">Stochastic Volatility Extension</h2>
<p>We present an additional framework where we model the conditional heteroskedasticity of the error terms in our BSVAR. <span class="math display">\[\begin{gather}
Y = XA + E \\
\\ E|X \sim MN_{T \times N}(0_{T \times N},diag(\sigma^2))
\end{gather}\]</span> where <span class="math display">\[\sigma^2 = \left\{exp(h_1),...,exp(h_T) \right\}\]</span> and each <span class="math inline">\(h\)</span> is obtained from a Stochastic Volatility model <span class="math display">\[\begin{gather}
\tilde{y}=h+\tilde{\epsilon}\\
Hh=h_0e_{1.T}+\sigma_v v\\
\tilde{\epsilon}|s \sim \mathcal{N}_T(\mu_s,diag(\sigma^2_s))\\
v \sim \mathcal{N}_T(0_T,I_T)\\
\end{gather}\]</span> where <span class="math inline">\(s\)</span>, <span class="math inline">\(\mu_s\)</span>, and <span class="math inline">\(\sigma_2^s\)</span>, are <span class="math inline">\(T\times1\)</span> vectors. The hierarchical prior is given by <span class="math display">\[p(h,s,h_0,\sigma^2_v)=p(h|h_0,\sigma^2_v)p(h0)p(\sigma^2_v)p(s)\]</span> and the prior distribution of <span class="math inline">\(h|h_0,\sigma^2_v\)</span> is given by <span class="math display">\[p(h|h_0,\sigma^2_v) \sim \mathcal{N}_t(h0H^{-1}e_{1.T},\sigma^2_v(H'H)^{-1}) \propto \det (\sigma^2_v I_T)^{-\frac{1}{2}}exp \left \{-\frac{1}{2}\frac{1}{\sigma^2_v}(Hh-h_0e_{1.T})'(Hh-h_0e_{1.T}) \right \}\]</span> and the marginal priors are <span class="math display">\[p(h_0)=\mathcal{N}(0,\underline{\sigma}^2_h)\]</span> <span class="math display">\[p(\sigma^2_v)=\mathcal{IG2}(\underline{s},\underline{\nu})\]</span> <span class="math display">\[p(s_t)=\mathcal{Multinomial}({m}_{m=1}^10,{Pr(s_t=m)}_{m=1}^10)\]</span> Combining the priors with the conditional likelihood <span class="math display">\[exp\left \{ -\frac{1}{2}(h-(\tilde{y}-\mu_s)'diag(\sigma_s^2)^{-1}(h-(\tilde{y}-\mu_s)) \right \}\]</span> we obtain the full conditional posterior of <span class="math inline">\(h|y,s,h_0,\sigma^2_v \sim \mathcal{N}_T(\bar{h}, \bar{V}_h)\)</span> with parameters: <span class="math display">\[\bar{H}_h= \left [ diag(\sigma_s^2)^{-1}+\sigma_v^{-2}H'H \right ]^{-1}\]</span> <span class="math display">\[\bar{h}=\bar{V}_h \left [diag(\sigma_s^2)^{-1}(\tilde{y}-\mu_s)+\sigma_v^{-2}h_0e_{1.T} \right ]\]</span> In addition, incorporating the results from the posterior distributions of <span class="math inline">\(h\)</span>, <span class="math inline">\(s\)</span>, <span class="math inline">\(\sigma^2_v\)</span>, and <span class="math inline">\(h_0\)</span>, we obtain the updated parameters of the full conditional posterior of our Matrix-Variate-normal and Inverse Wishart distribution: <span class="math display">\[\begin{gather}
\bar{V} = (X'diag(h)^{-1}X+(\kappa_A \underline{V}))^{-1} \\
\\ \bar{A} = \bar{V}(X'diag(h)^{-1}Y+(\kappa_A \underline{V}^{-1}\underline{A})) \\ \\ \bar{S} = I_N\kappa_{\Sigma}+Y'diag(h)^{-1}Y+\underline{A}^{'}(\kappa_A \underline{V})^{-1}\underline{A} - \bar{A}^{'} \bar{V}^{-1}\bar{A} \\
\\ \bar{\nu} = T + \underline{\nu}
\end{gather}\]</span></p>
<p>Based on the previous model, we can update the Gibbs sampler. Initialize <span class="math inline">\(\sigma^2\)</span>, <span class="math inline">\(\kappa_A\)</span> and <span class="math inline">\(\kappa_{\Sigma}\)</span> at <span class="math inline">\(\sigma^{2(0)}\)</span> <span class="math inline">\(\kappa_A^{(0)}\)</span> and <span class="math inline">\(\kappa^{(0)}_{\Sigma}\)</span>.</p>
<p>At each iteration i:</p>
<ol type="1">
<li>Draw <span class="math inline">\((A,\Sigma)^{(i)} \sim p(A,\Sigma\| X,Y,\kappa_A^{(i-1)},\kappa_{\Sigma}^{(i-1)},\sigma^{2(i-1)})\)</span></li>
<li>Draw <span class="math inline">\((\sigma^2)^{(i)} \sim p(h|y,s,h_0,\sigma^2_v)\)</span></li>
<li>Draw <span class="math inline">\(\kappa_A^{(i)} \sim p(\kappa_A|Y,X,A^{(i)},\Sigma^{(i)})\)</span></li>
<li>Draw <span class="math inline">\(\kappa_{\Sigma}^{(i)} \sim p(\kappa_{\Sigma}|Y,X,A^{(i)},\Sigma^{(i)})\)</span></li>
</ol>
<p>Repeat steps 1 and 2 for <span class="math inline">\((S_1 + S_2)\)</span> times. Discard the first <span class="math inline">\(S_1\)</span> repetitions. Return the output as <span class="math inline">\(\left \{ A^{(i)}, \Sigma^{(i)} \right \}^{S_2}_{i=S_1+1}\)</span>. Unfortunately, we are still working on our Stochastic Volatility Model function and do not have the final result. We display the code below.</p>
<div class="cell">
<details>
<summary>SV Model</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>SV.model <span class="ot">&lt;-</span> <span class="cf">function</span>(bigy, p, S1, S2){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ############################################################</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  SVcommon.Gibbs.iteration <span class="ot">&lt;-</span> <span class="cf">function</span>(aux, priors){</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A single iteration of the Gibbs sampler for the SV component</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># aux is a list containing:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   Y         - a TxN matrix</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   X         - a TxK matrix</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   H         - a Tx1 matrix                 </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   h0        - a scalar</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   sigma.v2  - a scalar</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   s         - a Tx1 matrix</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   A         - a KxN matrix</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   Sigma     - an NxN matrix</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   sigma2    - a Tx1 matrix</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># priors is a list containing:</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   h0.v      - a positive scalar</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   h0.m      - a scalar</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   sigmav.s  - a positive scalar</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   sigmav.nu - a positive scalar</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   HH        - a TxT matrix</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    T             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">1</span>]</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    N             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">2</span>]</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    alpha.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.92677</span>,<span class="fl">1.34744</span>,<span class="fl">0.73504</span>,<span class="fl">0.02266</span>,<span class="dv">0</span><span class="fl">-0.85173</span>,<span class="sc">-</span><span class="fl">1.97278</span>,<span class="sc">-</span><span class="fl">3.46788</span>,<span class="sc">-</span><span class="fl">5.55246</span>,<span class="sc">-</span><span class="fl">8.68384</span>,<span class="sc">-</span><span class="fl">14.65000</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    sigma.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.11265</span>,<span class="fl">0.17788</span>,<span class="fl">0.26768</span>,<span class="fl">0.40611</span>,<span class="fl">0.62699</span>,<span class="fl">0.98583</span>,<span class="fl">1.57469</span>,<span class="fl">2.54498</span>,<span class="fl">4.16591</span>,<span class="fl">7.33342</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    pi.st         <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.00609</span>,<span class="fl">0.04775</span>,<span class="fl">0.13057</span>,<span class="fl">0.20674</span>,<span class="fl">0.22715</span>,<span class="fl">0.18842</span>,<span class="fl">0.12047</span>,<span class="fl">0.05591</span>,<span class="fl">0.01575</span>,<span class="fl">0.00115</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    Lambda        <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">chol</span>(aux<span class="sc">$</span>Sigma[,,s]))</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    Z             <span class="ot">=</span> <span class="fu">rowSums</span>( ( aux<span class="sc">$</span>Y <span class="sc">-</span> aux<span class="sc">$</span>X <span class="sc">%*%</span> aux<span class="sc">$</span>A[,,s] ) <span class="sc">%*%</span> Lambda ) <span class="sc">/</span> <span class="fu">sqrt</span>(N)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    Y.tilde       <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">log</span>((Z <span class="sc">+</span> <span class="fl">0.0000001</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    Ytilde.alpha  <span class="ot">=</span> <span class="fu">as.matrix</span>(Y.tilde <span class="sc">-</span> alpha.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s[,s])])</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sampling initial condition</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    V.h0.bar      <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2[s]))</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    m.h0.bar      <span class="ot">=</span> V.h0.bar<span class="sc">*</span>((priors<span class="sc">$</span>h0.m <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (aux<span class="sc">$</span>H[<span class="dv">1</span>,s] <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2[s]))</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    h0.draw       <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> m.h0.bar, <span class="at">sd =</span> <span class="fu">sqrt</span>(V.h0.bar))</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    aux<span class="sc">$</span>h0[s]     <span class="ot">=</span> h0.draw    </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sampling sigma.v2</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    sigma.v2.s    <span class="ot">=</span> priors<span class="sc">$</span>sigmav.s <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">c</span>(aux<span class="sc">$</span>H[<span class="dv">1</span>,s] <span class="sc">-</span> aux<span class="sc">$</span>h0, <span class="fu">diff</span>(aux<span class="sc">$</span>H[,s]))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    sigma.v2.draw <span class="ot">=</span> sigma.v2.s <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, priors<span class="sc">$</span>sigmav.nu <span class="sc">+</span> T)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    aux<span class="sc">$</span>sigma.v2[s]  <span class="ot">=</span> sigma.v2.draw    </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sampling auxiliary states</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    Pr.tmp        <span class="ot">=</span> <span class="fu">simplify2array</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(x){</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">dnorm</span>(Y.tilde, <span class="at">mean =</span> <span class="fu">as.vector</span>(aux<span class="sc">$</span>H[,s] <span class="sc">+</span> alpha.st[x]), <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma.st[x]), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">log</span>(pi.st[x])</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    }))</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    Pr            <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr.tmp, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)))}))</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    s.cum         <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr, <span class="dv">1</span>, cumsum))</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    r             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">runif</span>(T), <span class="dv">10</span>), <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    ss            <span class="ot">=</span> <span class="fu">apply</span>(s.cum <span class="sc">&lt;</span> r, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    aux<span class="sc">$</span>s[,s]      <span class="ot">=</span> <span class="fu">as.matrix</span>(ss)       </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sampling log-volatilities using functions for tridiagonal precision matrix</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    Sigma.s.inv   <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s[,s])])</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    D.inv         <span class="ot">=</span> Sigma.s.inv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2[s]) <span class="sc">*</span> priors<span class="sc">$</span>HH</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    b             <span class="ot">=</span> <span class="fu">as.matrix</span>(Ytilde.alpha <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s[,s])] <span class="sc">+</span> (aux<span class="sc">$</span>h0[s]<span class="sc">/</span>aux<span class="sc">$</span>sigma.v2[s])<span class="sc">*</span><span class="fu">diag</span>(T)[,<span class="dv">1</span>])</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    lead.diag     <span class="ot">=</span> <span class="fu">diag</span>(D.inv)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    sub.diag      <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.inv, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    D.chol        <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">trichol</span>(<span class="at">ld =</span> lead.diag, <span class="at">sd =</span> sub.diag)</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    D.L           <span class="ot">=</span> <span class="fu">diag</span>(D.chol<span class="sc">$</span>ld)</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>    mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.L,<span class="sc">-</span><span class="dv">1</span>) <span class="ot">=</span> D.chol<span class="sc">$</span>sd</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    x             <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(T))</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    a             <span class="ot">=</span> <span class="fu">forwardsolve</span>(D.L, b)</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    draw          <span class="ot">=</span> <span class="fu">backsolve</span>(<span class="fu">t</span>(D.L), a <span class="sc">+</span> x)</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>    aux<span class="sc">$</span>H[,s]         <span class="ot">=</span> <span class="fu">as.matrix</span>(draw)         </span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    aux<span class="sc">$</span>sigma2[,s]    <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">exp</span>(draw))     </span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(aux)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>  Y       <span class="ot">=</span> bigy[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(bigy),]</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  X       <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(Y),<span class="dv">1</span>)</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>    X     <span class="ot">=</span> <span class="fu">cbind</span>(X,bigy[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(bigy)<span class="sc">-</span>i,])</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  T       <span class="ot">=</span> <span class="fu">nrow</span>(Y)</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  N       <span class="ot">=</span> <span class="fu">ncol</span>(Y)</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>  K       <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>  S<span class="ot">=</span>S1<span class="sc">+</span>S2 <span class="co">#sum of replications</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set the priors</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>  A.prior     <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,K,N) <span class="co">#try to put is as 0</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>  <span class="co">#A.prior[2:(N+1),] &lt;- diag(c(0,rep(1,N-1)))</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>  V.prior         <span class="ot">=</span> (<span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.02</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))) <span class="co">#1 is kappa.2, 0.02 is kappa.1</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>  nu.prior        <span class="ot">=</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>  <span class="co">#kappa.a priors</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>  nu.a.prior      <span class="ot">=</span> <span class="dv">200</span>    <span class="co">#ig2</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>  s.a.prior       <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>  <span class="co">#kappa.sigma priors</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  a.sigma.prior   <span class="ot">=</span> <span class="dv">10</span>  <span class="co">#rgamma</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  s.sigma.prior   <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>  k.sigma             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S, <span class="dv">1</span>)</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>  k.a                 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, S, <span class="dv">1</span>)</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>  k.sigma[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  k.a[<span class="dv">1</span>]     <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>  nu.bar      <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>  nu.bar.a    <span class="ot">=</span> nu.a.prior <span class="sc">+</span> N<span class="sc">*</span>K</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>  a.sigma.bar <span class="ot">=</span> (N<span class="sc">*</span>nu.prior)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>a.sigma.prior</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>  HH                    <span class="ot">&lt;-</span>  <span class="dv">2</span><span class="sc">*</span><span class="fu">diag</span>(T)</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(HH,<span class="sc">-</span><span class="dv">1</span>)    <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(HH,<span class="dv">1</span>)     <span class="ot">&lt;-</span>  <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>  H           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,S)</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sdiag</span>(H,<span class="sc">-</span><span class="dv">1</span>) <span class="ot">=</span>  <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">=</span> <span class="fu">list</span>(<span class="at">HH      =</span> HH,</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0.m    =</span> <span class="dv">0</span>,</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>                <span class="at">h0.v    =</span> <span class="dv">1</span>,</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigmav.s=</span> <span class="dv">1</span>,</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>                <span class="at">sigmav.nu=</span> <span class="dv">1</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>  aux <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y         =</span> Y,</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">X         =</span> X,</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">H         =</span> H,</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">h0        =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,S),</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.v2  =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,S),</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">s         =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,S),</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">A         =</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(K,N,S))), <span class="fu">c</span>(K, N, S)),</span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">B.post    =</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S)),</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigma     =</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S)),</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma2    =</span> <span class="fu">matrix</span>(<span class="dv">1</span>,T,S)</span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial values draws</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>  V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> (k.a[<span class="dv">1</span>]<span class="sc">^-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>  V.bar       <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>  A.bar       <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(k.a[<span class="dv">1</span>]<span class="sc">*</span>V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>  S.bar       <span class="ot">=</span> k.sigma[<span class="dv">1</span>]<span class="sc">*</span><span class="fu">diag</span>(N) <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(k.a[<span class="dv">1</span>]<span class="sc">*</span>V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>  S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>  L           <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>  Sigma.init  <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)[,,<span class="dv">1</span>])</span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>  cholSigma.s <span class="ot">=</span> <span class="fu">chol</span>(Sigma.init)</span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>  A.init      <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(K,N))), <span class="fu">c</span>(K, N))</span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>  A.init.     <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.init<span class="sc">%*%</span>cholSigma.s</span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>A[,,<span class="dv">1</span>]       <span class="ot">&lt;-</span> A.init </span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>Sigma[,,<span class="dv">1</span>]   <span class="ot">&lt;-</span> Sigma.init </span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>B.post[,,<span class="dv">1</span>]  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(Sigma.init))</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Posterior draws with SV</span></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>  Sigma.post   <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>  A.posterior  <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(K,N,S))), <span class="fu">c</span>(K, N, S))</span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>  B.posterior  <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S) {</span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>      aux <span class="ot">=</span> <span class="fu">SVcommon.Gibbs.iteration</span>(aux,priors)</span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>      <span class="co"># normal-inverse Wishart, IG2, and Gamma posterior parameters</span></span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a>      <span class="do">############################################################</span></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>      V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>(<span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>aux<span class="sc">$</span>sigma2[,s])<span class="sc">+</span><span class="fl">2e-10</span>)<span class="sc">%*%</span>X <span class="sc">+</span> (k.a[s]<span class="sc">^-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a>      V.bar       <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>      A.bar       <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>(<span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>aux<span class="sc">$</span>sigma2[,s])<span class="sc">+</span><span class="fl">2e-10</span>)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(k.a[s]<span class="sc">*</span>V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a>      S.bar       <span class="ot">=</span> k.sigma[s]<span class="sc">*</span><span class="fu">diag</span>(N) <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>(<span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>aux<span class="sc">$</span>sigma2[,s])<span class="sc">+</span><span class="fl">2e-10</span>)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(k.a[s]<span class="sc">*</span>V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a>      S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>      L           <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>      <span class="co"># posterior draws</span></span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>      <span class="do">############################################################</span></span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior.inv <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>      Sigma.posterior     <span class="ot">=</span> <span class="fu">solve</span>(Sigma.posterior.inv[,,<span class="dv">1</span>])</span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>      cholSigma.s         <span class="ot">=</span> <span class="fu">chol</span>(Sigma.posterior)</span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>      A.posterior[,,s]    <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span>cholSigma.s</span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>      B.posterior[,,s]    <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(Sigma.posterior))</span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>      Sigma.post[,,s]     <span class="ot">=</span> Sigma.posterior</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>      s.a.bar       <span class="ot">&lt;-</span> s.a.prior <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">diag</span>(Sigma.posterior.inv[,,<span class="dv">1</span>] <span class="sc">%*%</span> <span class="fu">t</span>(A.posterior[,,<span class="dv">1</span>]<span class="sc">-</span>A.prior)<span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior)) <span class="sc">%*%</span> (A.posterior[,,<span class="dv">1</span>]<span class="sc">-</span>A.prior)))</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>      s.sigma.bar   <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>(<span class="fu">diag</span>(Sigma.posterior.inv[,,<span class="dv">1</span>]))<span class="sc">^-</span><span class="dv">1</span>)<span class="sc">+</span>((s.sigma.prior)<span class="sc">^-</span><span class="dv">1</span>))<span class="sc">^-</span><span class="dv">1</span></span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>      <span class="co">#draw k.a from IG2 and k.sigma from gamma distribution</span></span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>      k.a[s<span class="sc">+</span><span class="dv">1</span>]      <span class="ot">&lt;-</span> s.a.bar <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar.a)</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>      k.sigma[s<span class="sc">+</span><span class="dv">1</span>]  <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1</span>, <span class="at">shape =</span> a.sigma.bar, <span class="at">scale =</span> s.sigma.bar)</span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Stochastic Volatility updating</span></span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>A[,,s]      <span class="ot">&lt;-</span> A.posterior[,,s]</span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>B.post[,,s] <span class="ot">&lt;-</span> B.posterior[,,s]</span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>      aux<span class="sc">$</span>Sigma[,,s]  <span class="ot">&lt;-</span> Sigma.post[,,s]</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (s <span class="sc">&lt;</span> S){</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>H[,(s<span class="sc">+</span><span class="dv">1</span>)]       <span class="ot">&lt;-</span> aux<span class="sc">$</span>H[,s]</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>h0[(s<span class="sc">+</span><span class="dv">1</span>)]       <span class="ot">&lt;-</span> aux<span class="sc">$</span>h0[s]</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>sigma.v2[(s<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> aux<span class="sc">$</span>sigma.v2[s]</span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>s[,(s<span class="sc">+</span><span class="dv">1</span>)]       <span class="ot">&lt;-</span> aux<span class="sc">$</span>s[,s]</span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>A[,,(s<span class="sc">+</span><span class="dv">1</span>)]      <span class="ot">&lt;-</span> aux<span class="sc">$</span>A[,,s]</span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>B.post[,,s]     <span class="ot">&lt;-</span> aux<span class="sc">$</span>B.post[,,s]</span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>Sigma[,,(s<span class="sc">+</span><span class="dv">1</span>)]  <span class="ot">&lt;-</span> aux<span class="sc">$</span>Sigma[,,s]</span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>        aux<span class="sc">$</span>sigma2[,(s<span class="sc">+</span><span class="dv">1</span>)]  <span class="ot">&lt;-</span> aux<span class="sc">$</span>sigma2[,s]</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return the parameters of interest</span></span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"A"</span> <span class="ot">=</span> A.posterior[,,S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"B"</span> <span class="ot">=</span> B.posterior[,,S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Sigma"</span> <span class="ot">=</span> Sigma.post[,,S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.a"</span> <span class="ot">=</span> k.a[S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.sigma"</span> <span class="ot">=</span> k.sigma[S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2], </span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"B.convergence"</span> <span class="ot">=</span> B.posterior[,,<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"A.convergence"</span> <span class="ot">=</span> A.posterior[,,<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Sigma.convergence"</span> <span class="ot">=</span> Sigma.post[,,<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.a.convergence"</span> <span class="ot">=</span> k.a[<span class="dv">1</span><span class="sc">:</span>S], </span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"k.sigma.convergence"</span> <span class="ot">=</span> k.sigma[<span class="dv">1</span><span class="sc">:</span>S],</span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"h.post"</span> <span class="ot">=</span> aux<span class="sc">$</span>sigma2[,S1<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>S2])</span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="artificial-data" class="level2">
<h2 class="anchored" data-anchor-id="artificial-data">Artificial Data</h2>
<p>To check if our models work, we employ artificial data. We generate two random walks <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span> with 1000 observations each simulated from a bivariate Gaussian random walk process. We plot the raw series and the first difference below:</p>
<div class="cell">
<details>
<summary>Artificial Data</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">420</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  y.art <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y1,y2)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">diff</span>(y.art), <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="st">"Artificial data first difference"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-artificial" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-artificial-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Artificial Data Plot</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Then, we use our two functions from the basic and extended model to simulate the intercept term posterior. We show in the plot that for 10 thousand draws we get an intercept close to zero for the <span class="math inline">\(A_{1,1}\)</span> and <span class="math inline">\(A_{1,2}\)</span> values. In addition, we get an identity matrix for the <span class="math inline">\(B_{1,1}\)</span> and <span class="math inline">\(B_{2,2}\)</span> values.</p>
<div class="cell">
<details>
<summary>Artificial Data Results</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">420</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  basic.artificial <span class="ot">&lt;-</span> <span class="fu">basic.model</span>(y.art, <span class="dv">1</span>, <span class="dv">10000</span>, <span class="fu">c</span>(), <span class="fu">c</span>())</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  extended.artificial <span class="ot">&lt;-</span> <span class="fu">extended.model</span>(y.art, <span class="dv">1</span>, <span class="dv">1000</span>, <span class="dv">9000</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  B.basic    <span class="ot">&lt;-</span> basic.artificial<span class="sc">$</span>B</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  A.basic    <span class="ot">&lt;-</span> basic.artificial<span class="sc">$</span>A</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  B.extended <span class="ot">&lt;-</span> extended.artificial<span class="sc">$</span>B.convergence</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  A.extended <span class="ot">&lt;-</span>extended.artificial<span class="sc">$</span>A.convergence</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, B.basic[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , B[<span class="dv">11</span>])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, B.basic[<span class="dv">2</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , B[<span class="dv">22</span>])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, A.basic[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , A[<span class="dv">11</span>])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, A.basic[<span class="dv">1</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , A[<span class="dv">12</span>])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato"</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, B.extended[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , B[<span class="dv">11</span>])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue3"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, B.extended[<span class="dv">2</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , B[<span class="dv">22</span>])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue3"</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, A.extended[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , A[<span class="dv">11</span>])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato3"</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, A.extended[<span class="dv">1</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , A[<span class="dv">12</span>])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-artificial-results" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-artificial-results-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Artificial Data Results</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Moreover, we also plot the histograms of the values <span class="math inline">\(\kappa_A\)</span> and <span class="math inline">\(\kappa_{\Sigma}\)</span> outlining their mean value. We also add a vertical line to define the mean parameter for all draws. In our original function, we have set the <span class="math inline">\(\kappa_{Sigma}\)</span> initial value to 1 and the results from 10 thousand draws indicate that the posterior median is <span class="math inline">\(\backsim0.04\)</span>. Similarly, we set the initial value of <span class="math inline">\(\kappa_A\)</span> to one and obtain a posterior distribution with a median close to one.</p>
<div class="cell">
<details>
<summary>Kappas Histograms Artifical Data</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(extended.artificial<span class="sc">$</span>k.a, <span class="at">breaks=</span><span class="st">"Freedman-Diaconis"</span>, <span class="at">col=</span><span class="st">'tomato3'</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Slope Hyperparameter "</span>, kappa[A])), <span class="at">border=</span>F)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(extended.artificial<span class="sc">$</span>k.a), <span class="at">col=</span><span class="st">'purple4'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(extended.artificial<span class="sc">$</span>k.sigma, <span class="at">breaks=</span><span class="st">"Freedman-Diaconis"</span>, <span class="at">col=</span><span class="st">'royalblue'</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Covariance Hyperparameter "</span>, kappa[Sigma])), <span class="at">border=</span>F, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.12</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(extended.artificial<span class="sc">$</span>k.sigma), <span class="at">col=</span><span class="st">'purple4'</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-artificial-histogram-extended1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-artificial-histogram-extended1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: Kappas Histograms Artificial Data</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="real-data" class="level2">
<h2 class="anchored" data-anchor-id="real-data">Real Data</h2>
<p>We repeat the same exercise for the data we employ in our empirical analysis. We report the trace plots of the <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span> value for the 1 Year Treasury Rate and PCE estimates. The estimates of the extended model display higher variance.</p>
<div class="cell">
<details>
<summary>Real Data Results</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  basic.results       <span class="ot">&lt;-</span> <span class="fu">basic.model</span>(y, <span class="dv">12</span>, <span class="dv">10000</span>, <span class="fu">c</span>(<span class="dv">1990</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">2010</span>,<span class="dv">12</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  extended.results    <span class="ot">&lt;-</span> <span class="fu">extended.model</span>(y, <span class="dv">12</span>, <span class="dv">500</span>, <span class="dv">10000</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, basic.results<span class="sc">$</span>Sigma[<span class="dv">2</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , Sigma[YTR])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue3"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, basic.results<span class="sc">$</span>Sigma[<span class="dv">3</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , Sigma[PCE])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue3"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, basic.results<span class="sc">$</span>A[<span class="dv">2</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , A[YTR])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato3"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, basic.results<span class="sc">$</span>A[<span class="dv">3</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"basic "</span> , A[PCE])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato3"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, extended.results<span class="sc">$</span>Sigma[<span class="dv">2</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , Sigma[YTR])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, extended.results<span class="sc">$</span>Sigma[<span class="dv">3</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , Sigma[PCE])), <span class="at">lwd=</span><span class="fl">0.3</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"royalblue"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, extended.results<span class="sc">$</span>A[<span class="dv">2</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , A[YTR])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, extended.results<span class="sc">$</span>A[<span class="dv">3</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"extended "</span> , A[PCE])), <span class="at">lwd=</span><span class="fl">0.4</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"tomato"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-real-results" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-real-results-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;7: Real Data Results</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We plot the <span class="math inline">\(\kappa\)</span> parameters for the extended model using the <span class="citation" data-cites="miranda2020us">Miranda-Agrippino and Rey (<a href="#ref-miranda2020us" role="doc-biblioref">2020</a>)</span> dataset. Our initial <span class="math inline">\(\kappa_A\)</span> and <span class="math inline">\(\kappa_{\Sigma}\)</span> value is equal to 1. We can observe that the data changes significantly for the hyperprior parameter for the slope, but the same cannot be said for the variance-covariance hyperprior.</p>
<div class="cell">
<details>
<summary>Kappas Histograms Extended Model</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(extended.results<span class="sc">$</span>k.a.convergence, <span class="at">breaks=</span><span class="st">"Freedman-Diaconis"</span>, <span class="at">col=</span><span class="st">'tomato3'</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Slope Hyperparameter "</span>, kappa[A])), <span class="at">border=</span>F,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">3.4</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(extended.results<span class="sc">$</span>k.a.convergence), <span class="at">col=</span><span class="st">'purple4'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(extended.results<span class="sc">$</span>k.sigma.convergence, <span class="at">breaks=</span><span class="st">"Freedman-Diaconis"</span>, <span class="at">col=</span><span class="st">'royalblue'</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Covariance Hyperparameter "</span>, kappa[Sigma])), <span class="at">border=</span>F)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(extended.results<span class="sc">$</span>k.sigma.convergence), <span class="at">col=</span><span class="st">'purple4'</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-artificial-histogram-extended2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-artificial-histogram-extended2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;8: Kappas Histograms Extended Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="impulse-response-functions" class="level2">
<h2 class="anchored" data-anchor-id="impulse-response-functions">Impulse Response Functions</h2>
<p>The impulse response functions are the dynamic causal effects of the underlying shocks <span class="math inline">\(u_t\)</span> on the economic measurements <span class="math inline">\(y_t\)</span>. Our model features the instrument in the first position. We will compute impulse response functions (IRFs) assuming that the instrument affects all the other variables exogenously. We define an IRF as a shock of the first variable in <span class="math inline">\(u_t\)</span> (the instrument) on the 14 variables <span class="math inline">\(n\)</span> of our model in <span class="math inline">\(Y_t\)</span> at time <span class="math inline">\(t\)</span> until time <span class="math inline">\(t+i\)</span>. In our case <span class="math inline">\(i=24\)</span> because we want to study the IRFs for two years as the original paper authors do. Compactly, we can describe the computations as follows: <span class="math display">\[\begin{gather}
\frac{\partial y_{n.t+1}}{\partial u_{1.t}}=\theta_{nj.i}
\end{gather}\]</span> <span class="citation" data-cites="MollerWolf2021LPVARS">Plagborg-Moller (<a href="#ref-MollerWolf2021LPVARS" role="doc-biblioref">2021</a>)</span> assumption regarding the invertibility of <span class="math inline">\(\varepsilon\)</span> is satisfied given our Cholesky decomposition: <span class="math display">\[
\begin{bmatrix}
b_0^{1,1} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{2,1} &amp; b_0^{2,2} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{3,1} &amp; b_0^{3,2} &amp; b_0^{3,3} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{4,1} &amp; b_0^{4,2} &amp; b_0^{4,3} &amp; b_0^{4,4} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{5,1} &amp; b_0^{5,2} &amp; b_0^{5,3} &amp; b_0^{5,4} &amp; b_0^{5,5} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{6,1} &amp; b_0^{6,2} &amp; b_0^{6,3} &amp; b_0^{6,4} &amp; b_0^{6,5} &amp; b_0^{6,6} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{7,1} &amp; b_0^{7,2} &amp; b_0^{7,3} &amp; b_0^{7,4} &amp; b_0^{7,5} &amp; b_0^{7,6} &amp; b_0^{7,7} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{8,1} &amp; b_0^{8,2} &amp; b_0^{8,3} &amp; b_0^{8,4} &amp; b_0^{8,5} &amp; b_0^{8,6} &amp; b_0^{8,7} &amp; b_0^{8,8} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{9,1} &amp; b_0^{9,2} &amp; b_0^{9,3} &amp; b_0^{9,4} &amp; b_0^{9,5} &amp; b_0^{9,6} &amp; b_0^{9,7} &amp; b_0^{9,8} &amp; b_0^{9,9} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{10,1} &amp; b_0^{10,2} &amp; b_0^{10,3} &amp; b_0^{10,4} &amp; b_0^{10,5} &amp; b_0^{10,6} &amp; b_0^{10,7} &amp; b_0^{10,8} &amp; b_0^{10,9} &amp; b_0^{10,10} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
b_0^{11,1} &amp; b_0^{11,2} &amp; b_0^{11,3} &amp; b_0^{11,4} &amp; b_0^{11,5} &amp; b_0^{11,6} &amp; b_0^{11,7} &amp; b_0^{11,8} &amp; b_0^{11,9} &amp; b_0^{11,10} &amp; b_0^{11,11} &amp; 0 &amp; 0 &amp; 0 \\
b_0^{12,1} &amp; b_0^{12,2} &amp; b_0^{12,3} &amp; b_0^{12,4} &amp; b_0^{12,5} &amp; b_0^{12,6} &amp; b_0^{12,7} &amp; b_0^{12,8} &amp; b_0^{12,9} &amp; b_0^{12,10} &amp; b_0^{12,11} &amp; b_0^{12,12} &amp; 0 &amp; 0 \\
b_0^{13,1} &amp; b_0^{13,2} &amp; b_0^{13,3} &amp; b_0^{13,4} &amp; b_0^{13,5} &amp; b_0^{13,6} &amp; b_0^{13,7} &amp; b_0^{13,8} &amp; b_0^{13,9} &amp; b_0^{13,10} &amp; b_0^{13,11} &amp; b_0^{13,12} &amp; b_0^{13,13} &amp; 0 \\
b_0^{14,1} &amp; b_0^{14,2} &amp; b_0^{14,3} &amp; b_0^{14,4} &amp; b_0^{14,5} &amp; b_0^{14,6} &amp; b_0^{14,7} &amp; b_0^{14,8} &amp; b_0^{14,9} &amp; b_0^{14,10} &amp; b_0^{14,11} &amp; b_0^{14,12} &amp; b_0^{14,13} &amp; b_0^{14,14} \\
\end{bmatrix}
\]</span></p>
<section id="irfs-basic-model" class="level3">
<h3 class="anchored" data-anchor-id="irfs-basic-model">IRFs Basic Model</h3>
<p>We will outline IRFs for both our basic and extended models, computing 20 thousand draws for our estimates. For our empirical estimation we employ a VAR(12). <span class="citation" data-cites="miranda2020us">Miranda-Agrippino and Rey (<a href="#ref-miranda2020us" role="doc-biblioref">2020</a>)</span> normalize the IRFs so that the Treasury rate has a percentage point increase at horizon 0, but we do not include this normalization. Because of this, we cannot interpret the degree of shock as the authors do. From the 14 variables, we present only ten of them. We abstain from plotting the global factor because it is simply computed as the inverse of global risk aversion. In addition, we do not plot US brokers &amp; dealers’ leverage and US banks’ leverage. This is because our main interests lies in spillovers of monetary policy outside the US. The abscissa scale is in months, given that we use monthly variables, and display the 68% and 90% density intervals. We will briefly outline the results. -Upon realisation, the one-year Treasury rate spikes in the first quarter, decreases in the third quarter and then hovers around zero in the remaining lags; -we observe the PCE deflator to shrink in the first two quarters and increases thereafter; -industrial production shrinks in the first three quarters, and then mean-reverts but in insignificant bands; -global real production excluding the financial hegemon provides insignificant results in the first two lags and then increases, similarly to global inflows; -the BIS real effective exchange rate increases upon realisation as expected following the monetary policy shock, decreasing from the second quarter onwards; -global risk aversion - the proxy for global risky asset prices - spikes and hoovers around zero from the third quarter; -global credit excluding the US decreases as expected in the first two quarters and then increases thereafter; -the leverage drop immediately, but contrary to the original paper it does not mean-revert in the first quarter, and EU banks’ leverage provides insignificant results;</p>
<div class="cell">
<details>
<summary>IRFs Basic Model</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Impulse response functions basic model</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Forecast Error Variance Decomposition</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">###########################################################</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">=</span><span class="fu">ncol</span>(y)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  h<span class="ot">=</span><span class="dv">24</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  S<span class="ot">=</span><span class="dv">10000</span> <span class="co">#S2 draws of the extended model</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  IRF.posterior     <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,h<span class="sc">+</span><span class="dv">1</span>,S))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  IRF.inf.posterior <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  FEVD.posterior    <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,h<span class="sc">+</span><span class="dv">1</span>,S))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  J                 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(N),<span class="fu">matrix</span>(<span class="dv">0</span>,N,N<span class="sc">*</span>(p<span class="dv">-1</span>))) <span class="co">#[I_N,0_{NxN(p-1)}]</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  A.bold          <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">t</span>(basic.results<span class="sc">$</span>A[<span class="dv">2</span><span class="sc">:</span>(<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),,s]),<span class="fu">cbind</span>(<span class="fu">diag</span>(N<span class="sc">*</span>(p<span class="dv">-1</span>)),<span class="fu">matrix</span>(<span class="dv">0</span>,N<span class="sc">*</span>(p<span class="dv">-1</span>),N)))  <span class="co">#rbind([A1...AP], cbind(I_{N(p-1)}, 0_{N(p-1)xN}))</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  IRF.inf.posterior[,,s]          <span class="ot">=</span> J <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">diag</span>(N<span class="sc">*</span>p)<span class="sc">-</span>A.bold) <span class="sc">%*%</span> <span class="fu">t</span>(J) <span class="co">#J*(I-A)^-1*J'</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  A.bold.power    <span class="ot">=</span> A.bold</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(h<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      IRF.posterior[,,i,s]        <span class="ot">=</span> basic.results<span class="sc">$</span>B[,,s] <span class="co">#first value is first IRF</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>      IRF.posterior[,,i,s]        <span class="ot">=</span> J <span class="sc">%*%</span> A.bold.power <span class="sc">%*%</span> <span class="fu">t</span>(J) <span class="sc">%*%</span>basic.results<span class="sc">$</span>B[,,s] <span class="co">#J*A*J'*B.posterior</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>      A.bold.power                <span class="ot">=</span> A.bold.power <span class="sc">%*%</span> A.bold</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (nn <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    FEVD.posterior[n,nn,i,s]  <span class="ot">=</span> <span class="fu">sum</span>(IRF.posterior[n,nn,<span class="dv">1</span><span class="sc">:</span>i,s]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    FEVD.posterior[,,i,s]         <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">apply</span>(FEVD.posterior[,,i,s],<span class="dv">1</span>,sum))<span class="sc">%*%</span>FEVD.posterior[,,i,s]</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  FEVD.posterior    <span class="ot">=</span> <span class="dv">100</span><span class="sc">*</span>FEVD.posterior</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#colours for IRFs</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  mcxs2  <span class="ot">=</span> <span class="st">"#379683"</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  mcxs3  <span class="ot">=</span> <span class="st">"#5CDB95"</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  mcxs4  <span class="ot">=</span> <span class="st">"#8EE4AF"</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  mcxs3.rgb   <span class="ot">=</span> <span class="fu">col2rgb</span>(mcxs3)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  mcxs3.shade1<span class="ot">=</span> <span class="fu">rgb</span>(mcxs3.rgb[<span class="dv">1</span>],mcxs3.rgb[<span class="dv">2</span>],mcxs3.rgb[<span class="dv">3</span>], <span class="at">alpha=</span><span class="dv">120</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  mcxs4.rgb   <span class="ot">=</span> <span class="fu">col2rgb</span>(mcxs4)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  mcxs4.shade1<span class="ot">=</span> <span class="fu">rgb</span>(mcxs4.rgb[<span class="dv">1</span>],mcxs4.rgb[<span class="dv">2</span>],mcxs4.rgb[<span class="dv">3</span>], <span class="at">alpha=</span><span class="dv">120</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot IRFs basic model</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">#load("irf-instrument-fevd.RData")</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  IRF.posterior.inst <span class="ot">=</span> IRF.posterior[,<span class="dv">1</span>,,] <span class="co">#takes the instruments IRFs</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  IRFs.k1           <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,mean) <span class="co">#mean of the S IRFs</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  IRFs.inf.k1       <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst,<span class="dv">1</span>,mean)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(IRFs.k1) <span class="ot">=</span> y.names</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  IRFs.k1.hdi    <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,hdi, <span class="at">credMass=</span><span class="fl">0.68</span>)</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  IRFs.k1.hdi2    <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,hdi, <span class="at">credMass=</span><span class="fl">0.9</span>)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  hh          <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>(h<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf(file="FF-irf-mps1.pdf", height=9, width=12)</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">1.5</span>),<span class="at">cex.axis=</span><span class="fl">0.8</span>, <span class="at">cex.lab=</span><span class="fl">0.8</span>, <span class="at">cex.main=</span><span class="fl">0.9</span>)</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  IRFs.wanted      <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>)</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>){</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n <span class="sc">%in%</span> IRFs.wanted) {</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>  ylims     <span class="ot">=</span> <span class="fu">range</span>(IRFs.k1[n,hh],IRFs.k1.hdi[,n,hh])</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(hh,IRFs.k1[n,hh], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">ylim=</span>ylims, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">main =</span><span class="fu">rownames</span>(IRFs.k1)[n])</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(hh, IRFs.k1[n,hh], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>mcxs2)</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">24</span>),<span class="fu">c</span>(<span class="st">"4"</span>,<span class="st">"8"</span>,<span class="st">"12"</span>,<span class="st">"16"</span>,<span class="st">"20"</span>,<span class="st">"24"</span>))</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(ylims[<span class="dv">1</span>],<span class="dv">0</span>,ylims[<span class="dv">2</span>]),<span class="fu">round</span>(<span class="fu">c</span>(ylims[<span class="dv">1</span>],<span class="dv">0</span>,ylims[<span class="dv">2</span>]),<span class="dv">3</span>))</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(IRFs.k1.hdi[<span class="dv">1</span>,n,hh],IRFs.k1.hdi[<span class="dv">2</span>,n,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>mcxs3.shade1,<span class="at">border=</span>mcxs3.shade1)</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(IRFs.k1.hdi2[<span class="dv">1</span>,n,hh],IRFs.k1.hdi2[<span class="dv">2</span>,n,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>mcxs4.shade1,<span class="at">border=</span>mcxs4.shade1)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-irf-basic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-irf-basic-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;9: IRFs Basic Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fevd-basic-model" class="level3">
<h3 class="anchored" data-anchor-id="fevd-basic-model">FEVD Basic Model</h3>
<p>Moreover, we include forecast error variance decomposition (FEVD) of two variables, i.e.&nbsp;EU Global banks’ leverage, and EU big but systemic banks leverage. FEVD provide the information of how much each variable contributes to the information of the other variables’ forecast variability at each horizon. We can observe that the FEVD for Global banks the other variables account significantly for the aforementioned information at further horizons. As a matter of fact, the information provided by the variable of interest contributes for only 12% at the last horizon. The larger contributors at the last horizon are the leverage of US and EU global but not systematically important banks (&gt;38%).</p>
<div class="cell">
<details>
<summary>FEVD Basic Model for EU Global Banks’ Leverage</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># colours for FEVDs</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  colours <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"deepskyblue1"</span>,<span class="st">"deepskyblue2"</span>,<span class="st">"deepskyblue"</span>,<span class="st">"deepskyblue3"</span>,<span class="st">"deepskyblue4"</span>,<span class="st">"dodgerblue"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"dodgerblue1"</span>,<span class="st">"dodgerblue2"</span>,<span class="st">"maroon1"</span>,<span class="st">"maroon"</span>,<span class="st">"maroon2"</span>,<span class="st">"magenta"</span>,<span class="st">"maroon3"</span>,<span class="st">"maroon4"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot FEVDs for EU Global Banks' leverage</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  fevd.eubdlev  <span class="ot">=</span> <span class="fu">apply</span>(FEVD.posterior[<span class="dv">12</span>,,,],<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,mean)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  fevd.eubdlev  <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,h<span class="sc">+</span><span class="dv">1</span>),<span class="fu">apply</span>(fevd.eubdlev,<span class="dv">2</span>,cumsum))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">4</span>),<span class="at">cex.axis=</span><span class="dv">1</span>, <span class="at">cex.lab=</span><span class="fl">0.8</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(hh,fevd.eubdlev[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">"n"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">main =</span> <span class="st">"FEVD EU Global Banks leverage Basic Model"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>,hh,<span class="fu">c</span>(<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"4"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"8"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"12"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"16"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"20"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"24"</span>,<span class="st">""</span>),<span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>),<span class="fu">c</span>(<span class="st">""</span>,<span class="st">"EUBDLEV"</span>,<span class="st">""</span>), <span class="at">cex.axis=</span><span class="fl">0.9</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>   <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(fevd.eubdlev[n,hh],fevd.eubdlev[n<span class="sc">+</span><span class="dv">1</span>,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>colours[n],<span class="at">border=</span>colours[n])</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">4</span>,(<span class="fl">0.5</span><span class="sc">*</span>(fevd.eubdlev[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">25</span>]<span class="sc">+</span>fevd.eubdlev[<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">25</span>]))[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">14</span>)], <span class="fu">c</span>(<span class="st">"Treasury rate"</span>,<span class="st">"EUBANKSL"</span>),<span class="at">cex.axis=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fevd-basic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fevd-basic-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;10: FEVD Basic Model for EU Global Banks’ Leverage</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In addition, similar conclusions can be drawn to the FEVD of EU big but systematic banks’ leverage. The information provided by the variable of interest contributes for 12% at the last horizon. Other larger contributors at the last horizon are Leverage for EU global banks and US banks.</p>
<div class="cell">
<details>
<summary>FEVD Basic Model for EU Banks’ Leverage</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot FEVDs for EU banks' leverage</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  fevd.eulev  <span class="ot">=</span> <span class="fu">apply</span>(FEVD.posterior[<span class="dv">14</span>,,,],<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,mean) <span class="co">#real gdp</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  fevd.eulev  <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,h<span class="sc">+</span><span class="dv">1</span>),<span class="fu">apply</span>(fevd.eulev,<span class="dv">2</span>,cumsum))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf(file="fevd-inst.pdf", height=7, width=12)</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">4</span>),<span class="at">cex.axis=</span><span class="dv">1</span>, <span class="at">cex.lab=</span><span class="fl">0.8</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(hh,fevd.eulev[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">"n"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">main=</span><span class="st">"FEVD EU Banks leverage Basic Model"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>,hh,<span class="fu">c</span>(<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"4"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"8"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"12"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"16"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"20"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"24"</span>,<span class="st">""</span>),<span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>),<span class="fu">c</span>(<span class="st">""</span>,<span class="st">"EUBANKSL"</span>,<span class="st">""</span>),<span class="at">cex.axis=</span><span class="fl">0.9</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(fevd.eulev[n,hh],fevd.eulev[n<span class="sc">+</span><span class="dv">1</span>,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>colours[n],<span class="at">border=</span>colours[n])</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">4</span>,(<span class="fl">0.5</span><span class="sc">*</span>(fevd.eulev[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">25</span>]<span class="sc">+</span>fevd.eulev[<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">25</span>]))[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">13</span>)], <span class="fu">c</span>(<span class="st">"Treasury rate"</span>,<span class="st">"Leverage US Banks"</span>),<span class="at">cex.axis=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fevd-basic1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fevd-basic1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;11: FEVD Basic Model for EU Banks’ Leverage</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="irfs-extended-model" class="level3">
<h3 class="anchored" data-anchor-id="irfs-extended-model">IRFs Extended Model</h3>
<p>Regarding the extended model, the IRFs are generally in line with previous results or expectations. The treasury rate decreases upon realization of the shock and then hoovers around zero. The PCE displays a puzzling behavior, remaining constant in the first two lags following the shock. The remaining variables show a similar pattern compared to the basic model, but in general we can observe more insightful shapes at further lags. Generally, we observe significant responses to be temporary and not persisent. We have worked on tuning different parameters for the <span class="math inline">\(\kappa_A\)</span> and <span class="math inline">\(\kappa_{\Sigma}\)</span> hyperpriors, but we still have to identify the drivers of the PCE results.</p>
<div class="cell">
<details>
<summary>IRFs Extended Model</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extended model Impulse response functions</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Forecast Error Variance Decomposition</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">###########################################################</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span><span class="dv">12</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  IRF.posterior2     <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,h<span class="sc">+</span><span class="dv">1</span>,S))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  IRF.inf.posterior2 <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  FEVD.posterior2    <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,h<span class="sc">+</span><span class="dv">1</span>,S))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  J2                 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(N),<span class="fu">matrix</span>(<span class="dv">0</span>,N,N<span class="sc">*</span>(p<span class="dv">-1</span>))) <span class="co">#[I_N,0_{NxN(p-1)}]</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  A.bold2          <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">t</span>(extended.results<span class="sc">$</span>A[<span class="dv">2</span><span class="sc">:</span>(<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),,s]),<span class="fu">cbind</span>(<span class="fu">diag</span>(N<span class="sc">*</span>(p<span class="dv">-1</span>)),<span class="fu">matrix</span>(<span class="dv">0</span>,N<span class="sc">*</span>(p<span class="dv">-1</span>),N)))  <span class="co">#rbind([A1...AP], cbind(I_{N(p-1)}, 0_{N(p-1)xN}))</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  IRF.inf.posterior2[,,s]          <span class="ot">=</span> J2 <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">diag</span>(N<span class="sc">*</span>p)<span class="sc">-</span>A.bold2) <span class="sc">%*%</span> <span class="fu">t</span>(J2) <span class="co">#J*(I-A)^-1*J'</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  A.bold.power2    <span class="ot">=</span> A.bold2</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(h<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>      IRF.posterior2[,,i,s]        <span class="ot">=</span> extended.results<span class="sc">$</span>B[,,s] <span class="co">#first value is first IRF</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      IRF.posterior2[,,i,s]        <span class="ot">=</span> J2 <span class="sc">%*%</span> A.bold.power2 <span class="sc">%*%</span> <span class="fu">t</span>(J2) <span class="sc">%*%</span>extended.results<span class="sc">$</span>B[,,s] <span class="co">#J*A*J'*B.posterior</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>      A.bold.power2                <span class="ot">=</span> A.bold.power2 <span class="sc">%*%</span> A.bold2</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (nn <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    FEVD.posterior2[n,nn,i,s]  <span class="ot">=</span> <span class="fu">sum</span>(IRF.posterior2[n,nn,<span class="dv">1</span><span class="sc">:</span>i,s]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    FEVD.posterior2[,,i,s]         <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">apply</span>(FEVD.posterior2[,,i,s],<span class="dv">1</span>,sum))<span class="sc">%*%</span>FEVD.posterior2[,,i,s]</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  FEVD.posterior2    <span class="ot">=</span> <span class="dv">100</span><span class="sc">*</span>FEVD.posterior2</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot IRFs extended model</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  IRF.posterior.inst2 <span class="ot">=</span> IRF.posterior2[,<span class="dv">1</span>,,] <span class="co">#takes the instruments IRFs</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  IRFs.k12           <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst2,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,mean) <span class="co">#mean of the S IRFs</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  IRFs.inf.k12       <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst2,<span class="dv">1</span>,mean)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(IRFs.k12) <span class="ot">=</span> y.names</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  IRFs.k1.hdi3    <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst2,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,hdi, <span class="at">credMass=</span><span class="fl">0.68</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  IRFs.k1.hdi4    <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.inst2,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,hdi, <span class="at">credMass=</span><span class="fl">0.9</span>)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  hh          <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>(h<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">1.5</span>),<span class="at">cex.axis=</span><span class="fl">0.8</span>, <span class="at">cex.lab=</span><span class="fl">0.8</span>, <span class="at">cex.main=</span><span class="fl">0.9</span>)</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>){</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n <span class="sc">%in%</span> IRFs.wanted) {</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>  ylims     <span class="ot">=</span> <span class="fu">range</span>(IRFs.k12[n,hh],IRFs.k1.hdi3[,n,hh])</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(hh,IRFs.k12[n,hh], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">ylim=</span>ylims, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">main =</span><span class="fu">rownames</span>(IRFs.k12)[n])</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(hh, IRFs.k12[n,hh], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>mcxs2)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">24</span>),<span class="fu">c</span>(<span class="st">"4"</span>,<span class="st">"8"</span>,<span class="st">"12"</span>,<span class="st">"16"</span>,<span class="st">"20"</span>,<span class="st">"24"</span>))</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(ylims[<span class="dv">1</span>],<span class="dv">0</span>,ylims[<span class="dv">2</span>]),<span class="fu">round</span>(<span class="fu">c</span>(ylims[<span class="dv">1</span>],<span class="dv">0</span>,ylims[<span class="dv">2</span>]),<span class="dv">3</span>))</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(IRFs.k1.hdi3[<span class="dv">1</span>,n,hh],IRFs.k1.hdi3[<span class="dv">2</span>,n,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>mcxs3.shade1,<span class="at">border=</span>mcxs3.shade1)</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(IRFs.k1.hdi4[<span class="dv">1</span>,n,hh],IRFs.k1.hdi4[<span class="dv">2</span>,n,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>mcxs4.shade1,<span class="at">border=</span>mcxs4.shade1)</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-irf-extended" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-irf-extended-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;12: IRFs Extended Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fevd-extended-model" class="level3">
<h3 class="anchored" data-anchor-id="fevd-extended-model">FEVD Extended Model</h3>
<p>We also plot the same FEVD of the same variables of the previous section. Differenyly from IRFs, the extended model FEVDs are almost identical to the ones of the basic model.</p>
<div class="cell">
<details>
<summary>FEVD Extended Model for EU Global Banks’ Leverage</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot FEVDs for EU Global Banks' leverage</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  fevd.eubdlev2  <span class="ot">=</span> <span class="fu">apply</span>(FEVD.posterior2[<span class="dv">12</span>,,,],<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,mean)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  fevd.eubdlev2  <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,h<span class="sc">+</span><span class="dv">1</span>),<span class="fu">apply</span>(fevd.eubdlev2,<span class="dv">2</span>,cumsum))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>),<span class="at">cex.axis=</span><span class="dv">1</span>, <span class="at">cex.lab=</span><span class="fl">0.8</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(hh,fevd.eubdlev2[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">"n"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">main =</span> <span class="st">"FEVD EU Global Banks leverage Extended Model"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">axis</span>(<span class="dv">1</span>,hh,<span class="fu">c</span>(<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"4"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"8"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"12"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"16"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"20"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"24"</span>,<span class="st">""</span>),<span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>),<span class="fu">c</span>(<span class="st">""</span>,<span class="st">"EUBDLEV "</span>,<span class="st">""</span>), <span class="at">cex.axis=</span><span class="fl">0.9</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(fevd.eubdlev2[n,hh],fevd.eubdlev2[n<span class="sc">+</span><span class="dv">1</span>,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>colours[n],<span class="at">border=</span>colours[n])</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">4</span>,(<span class="fl">0.5</span><span class="sc">*</span>(fevd.eubdlev2[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">25</span>]<span class="sc">+</span>fevd.eubdlev2[<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">25</span>]))[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">14</span>)], <span class="fu">c</span>(<span class="st">"Treasury rate"</span>,<span class="st">"EUBANKSL"</span>),<span class="at">cex.axis=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fevd-extended1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fevd-extended1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;13: FEVD Extended Model for EU Global Banks’ Leverage</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>FEVD Extended Model for EU Banks’ Leverage</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot FEVDs for EU banks' leverage</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  fevd.eulev2  <span class="ot">=</span> <span class="fu">apply</span>(FEVD.posterior2[<span class="dv">14</span>,,,],<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,mean) <span class="co">#real gdp</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  fevd.eulev2  <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,h<span class="sc">+</span><span class="dv">1</span>),<span class="fu">apply</span>(fevd.eulev2,<span class="dv">2</span>,cumsum))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pdf(file="fevd-inst.pdf", height=7, width=12)</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">4</span>),<span class="at">cex.axis=</span><span class="dv">1</span>, <span class="at">cex.lab=</span><span class="fl">0.8</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(hh,fevd.eulev2[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">"n"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">main=</span><span class="st">"FEVD EU Banks leverage Basic Model"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>,hh,<span class="fu">c</span>(<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"4"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"8"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"12"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"16"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"20"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"24"</span>,<span class="st">""</span>),<span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>),<span class="fu">c</span>(<span class="st">""</span>,<span class="st">"EUBANKSL"</span>,<span class="st">""</span>),<span class="at">cex.axis=</span><span class="fl">0.9</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(fevd.eulev2[n,hh],fevd.eulev[n<span class="sc">+</span><span class="dv">1</span>,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>colours[n],<span class="at">border=</span>colours[n])</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">4</span>,(<span class="fl">0.5</span><span class="sc">*</span>(fevd.eulev2[<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">25</span>]<span class="sc">+</span>fevd.eulev2[<span class="dv">2</span><span class="sc">:</span><span class="dv">15</span>,<span class="dv">25</span>]))[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">13</span>)], <span class="fu">c</span>(<span class="st">"Treasury rate"</span>,<span class="st">"Leverage US Banks"</span>),<span class="at">cex.axis=</span><span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fevd-extended2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fevd-extended2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;14: FEVD Extended Model for EU Banks’ Leverage</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="irfs-sv-model" class="level3">
<h3 class="anchored" data-anchor-id="irfs-sv-model">IRFs SV Model</h3>
<p>Unfortunately, we are still working on the IRFs of the Stochastic Volatility model.</p>
<div class="cell">
<details>
<summary>IRFs SV Model</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Impulse response functions basic model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   # Forecast Error Variance Decomposition</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   ###########################################################</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   SV.results       &lt;- SV.model(y, 4, 500, 10000)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   N=ncol(y)</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   h=24</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   p=4</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   S=10000 #S2 draws of the extended model</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRF.posterior3     = array(NA,c(N,N,h+1,S))</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRF.inf.posterior3 = array(NA,c(N,N,S))</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   FEVD.posterior3    = array(NA,c(N,N,h+1,S))</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   J3                 = cbind(diag(N),matrix(0,N,N*(p-1))) #[I_N,0_{NxN(p-1)}]</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   for (s in 1:S){</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   A.bold3          = rbind(t(SV.results$A[2:(1+N*p),,s]),cbind(diag(N*(p-1)),matrix(0,N*(p-1),N)))  #rbind([A1...AP], cbind(I_{N(p-1)}, 0_{N(p-1)xN}))</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRF.inf.posterior3[,,s]          = J3 %*% solve(diag(N*p)-A.bold3) %*% t(J) #J*(I-A)^-1*J'</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   A.bold.power3    = A.bold3</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   for (i in 1:(h+1)){</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     if (i==1){</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#       IRF.posterior3[,,i,s]        = SV.results$B[,,s] #first value is first IRF</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#     } else {</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#       IRF.posterior3[,,i,s]        = J3 %*% A.bold.power3 %*% t(J3) %*%SV.results$B[,,s] #J*A*J'*B.posterior</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co">#       A.bold.power3                = A.bold.power3 %*% A.bold3</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     for (n in 1:N){</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     for (nn in 1:N){</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     FEVD.posterior3[n,nn,i,s]  = sum(IRF.posterior3[n,nn,1:i,s]^2)</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co">#      }</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     FEVD.posterior3[,,i,s]         = diag(1/apply(FEVD.posterior3[,,i,s],1,sum))%*%FEVD.posterior3[,,i,s]</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   FEVD.posterior3    = 100*FEVD.posterior3</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   # plot IRFs basic model</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ############################################################</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   #load("irf-instrument-fevd.RData")</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRF.posterior.inst3 = IRF.posterior3[,1,,] #takes the instruments IRFs</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRFs.k13            = apply(IRF.posterior.inst3,1:2,mean) #mean of the S IRFs</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRFs.inf.k13        = apply(IRF.posterior.inst3,1,mean)</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   rownames(IRFs.k13)  = y.names</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRFs.k1.hdi3     = apply(IRF.posterior.inst3,1:2,hdi, credMass=0.68)</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRFs.k1.hdi23    = apply(IRF.posterior.inst3,1:2,hdi, credMass=0.9)</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="co">#   hh          = 1:(h+1)</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="co">#   #pdf(file="FF-irf-mps1.pdf", height=9, width=12)</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="co">#   par(mfrow=c(5,2), mar=c(2, 2, 2, 1.5),cex.axis=0.8, cex.lab=0.8, cex.main=0.9)</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="co">#   IRFs.wanted      &lt;- c(2,3,4,5,6,7,9,10,12,14)</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   for (n in 1:14){</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="co">#     if (n %in% IRFs.wanted) {</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylims     = range(IRFs.k13[n,hh],IRFs.k1.hdi3[,n,hh])</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(hh,IRFs.k13[n,hh], type="l", ylim=ylims, axes=FALSE, xlab="", ylab="", main =rownames(IRFs.k13)[n])</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   lines(hh, IRFs.k13[n,hh], lwd=2, col=mcxs2)</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   axis(1,c(4,8,12,16,20,24),c("4","8","12","16","20","24"))</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="co">#   axis(2,c(ylims[1],0,ylims[2]),round(c(ylims[1],0,ylims[2]),3))</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a><span class="co">#   polygon(c(hh,(h+1):1), c(IRFs.k1.hdi3[1,n,hh],IRFs.k1.hdi3[2,n,(h+1):1]), col=mcxs3.shade1,border=mcxs3.shade1)</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="co">#   polygon(c(hh,(h+1):1), c(IRFs.k1.hdi23[1,n,hh],IRFs.k1.hdi23[2,n,(h+1):1]), col=mcxs4.shade1,border=mcxs4.shade1)</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="co">#   abline(h=0)</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this project, we have estimated a Bayesian SVAR with three different methods. Unfortunately we still need to work on the hyperprior specifications of the Stochastic Volatility model. The IRFs of the basic and extended model are a good starting point, but there is stil work to do to estimate the model as <span class="citation" data-cites="miranda2020us">Miranda-Agrippino and Rey (<a href="#ref-miranda2020us" role="doc-biblioref">2020</a>)</span>.</p>
</section>
</div>
<p>$$</p>
<p>$$</p>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-HRW2022ProxySVARs" class="csl-entry" role="doc-biblioentry">
Herwartz, Hannes, Helmut &amp; Rohloff. 2021. <span>“Proxy SVAR Identification of Monetary Policy Shocks - Monte Carlo Evidence and Insights for the US.”</span> <em>Journal of Economic Dynamics &amp; Control</em> 139 (104457).
</div>
<div id="ref-miranda2020us" class="csl-entry" role="doc-biblioentry">
Miranda-Agrippino, Silvia, and H’elene Rey. 2020. <span>“US Monetary Policy and the Global Financial Cycle.”</span> <em>The Review of Economic Studies</em> 87 (6): 2754–76.
</div>
<div id="ref-MollerWolf2021LPVARS" class="csl-entry" role="doc-biblioentry">
Plagborg-Moller, Christian, Mikkel &amp; K. Wolf. 2021. <span>“Local Projections and VARS Estimate the Same Impulse Reponses.”</span> <em>Econometrica</em> 89 (2): 955–80.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>